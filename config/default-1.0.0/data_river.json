{
  "rivers": [
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.qmpc.ItemChange",
        "send_to_redis": false,
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "pc-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "yun_not_edit_add",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "(\"type\":\"add\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"add\")|(\"type\":\"update\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"update\")"
                },
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"edit\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"addSkuIds\":\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"addSkuIds\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.pc.es.api.EsGoodsQueryProvider",
            "request": {
              "method": "listByIdString",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}",
                  "hashcode": {}
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_vip",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_experience",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "yun_not_edit_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "(\"type\":\"add\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"add\")|(\"type\":\"update\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"update\")"
                },
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"edit\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"updateSkuIds\":\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"updateSkuIds\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.pc.es.api.EsGoodsQueryProvider",
            "request": {
              "method": "listByIdString",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}",
                  "hashcode": {}
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_vip",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_experience",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "yun_edit_add",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "(\"type\":\"add\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"add\")|(\"type\":\"update\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"update\")"
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"edit\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"addSkuIds\":\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"addSkuIds\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.pc.es.api.EsGoodsQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "listByIdString",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_vip",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_experience",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "yun_edit_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "(\"type\":\"add\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"add\")|(\"type\":\"update\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"update\")"
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"edit\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"updateSkuIds\":\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"updateSkuIds\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.pc.es.api.EsGoodsQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "listByIdString",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_vip",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_experience",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "yun_edit_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"deleteSkuIds\":\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"sys\":[02]"
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"deleteSkuIds\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_vip",
                    "operation": "delete",
                    "id": "{ids}",
                    "id_process": {
                      "type": "seperate",
                      "separator": ":"
                    },
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_experience",
                    "operation": "delete",
                    "id": "{ids}",
                    "id_process": {
                      "type": "seperate",
                      "separator": ":"
                    },
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "spu_yun_not_edit",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "(\"type\":\"add\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"add\")|(\"type\":\"update\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"update\")"
                },
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"edit\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.pc.es.api.EsProductQueryProvider",
            "request": {
              "method": "listByIdString",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_vip",
                    "operation": "create",
                    "id": "{spuId}",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_experience",
                    "operation": "create",
                    "id": "{spuId}",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "spu_yun_edit_add",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "(\"type\":\"add\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"add\")|(\"type\":\"update\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"update\")"
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"edit\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"addSkuIds\":\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"addSkuIds\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.pc.es.api.EsProductQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "listByIdString",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_vip",
                    "operation": "create",
                    "id": "{spuId}",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_experience",
                    "operation": "create",
                    "id": "{spuId}",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "spu_yun_edit_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "(\"type\":\"add\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"add\")|(\"type\":\"update\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"update\")"
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"edit\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"updateSkuIds\":\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"updateSkuIds\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.pc.es.api.EsProductQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "listByIdString",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_vip",
                    "operation": "create",
                    "id": "{spuId}",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_experience",
                    "operation": "create",
                    "id": "{spuId}",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "spu_yun_edit_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"delete\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"sys\":[02]"
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": {
                  "type": "script",
                  "language": "python",
                  "obj_path": "script_data_parsers.parse_spuids_from_pc_mq_msg",
                  "input_param": {
                    "fields": {
                      "pc_ids": {
                        "type": "regex",
                        "expression": "\"ids\":\"(?P<pc_ids>[\\d\\D]+?)\""
                      },
                      "sep_char": {
                        "type": "fixed",
                        "expression": ","
                      }
                    }
                  }
                },
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_vip",
                    "operation": "delete",
                    "id": "{ids}",
                    "id_process": {
                      "type": "seperate",
                      "separator": ","
                    },
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_experience",
                    "operation": "delete",
                    "id": "{ids}",
                    "id_process": {
                      "type": "seperate",
                      "separator": ","
                    },
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.qmpc.EsInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "pc-"
          }
        }
      },
      "branches": [
        {
          "name": "yun_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"sys\":[02]"
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "fromSys": "sys\":(?P<fromSys>[\\d]+?)",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.pc.es.api.EsGoodsQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "query",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "fromSys": "{fromSys}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_vip",
                    "operation": "create",
                    "id": "{skuId}",
                    "clear_policy": "every_msg,by_adminId",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_experience",
                    "operation": "create",
                    "id": "{skuId}",
                    "clear_policy": "every_msg,by_adminId",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "spu_yun_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"sys\":[02]"
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "fromSys": "sys\":(?P<fromSys>[\\d]+?)",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.pc.es.api.EsProductQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "query",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "fromSys": "{fromSys}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_vip",
                    "operation": "create",
                    "id": "{spuId}",
                    "clear_policy": "every_msg,by_adminId",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_experience",
                    "operation": "create",
                    "id": "{spuId}",
                    "clear_policy": "every_msg,by_adminId",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.cloudshop.platform.initMarketing",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "cloudshop_marketing_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": []
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "domain_type": "domainType\":\"(?P<domain_type>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.cloudshop.api.es.ESMarketingProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryMarketingList4ESearch",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "domainType": "{domain_type}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "operation": "create",
              "index": "cloudshop-marketing-{hashcode}-{version}",
              "id": "{marketingId}",
              "type": "Marketing",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.cloudshop.platform.marketingChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "cloudshop_marketing_add",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"add\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "domain_type": "domainType\":\"(?P<domain_type>[\\d\\D]+?)\"",
                "ids": "\"marketingId\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.cloudshop.api.es.ESMarketingProvider",
            "request": {
              "method": "queryMarketingList4ESearchByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "domainType": "{domain_type}",
                "marketingId": "{ids}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "operation": "create",
              "index": "cloudshop-marketing-{hashcode}-{version}",
              "id": "{marketingId}",
              "type": "Marketing",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "cloudshop_marketing_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"update\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "domain_type": "domainType\":\"(?P<domain_type>[\\d\\D]+?)\"",
                "ids": "\"marketingId\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.cloudshop.api.es.ESMarketingProvider",
            "request": {
              "method": "queryMarketingList4ESearchByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "domainType": "{domain_type}",
                "marketingId": "{ids}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "operation": "create",
              "index": "cloudshop-marketing-{hashcode}-{version}",
              "id": "{marketingId}",
              "type": "Marketing",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "cloudshop_marketing_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"marketingId\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "operation": "delete",
              "index": "cloudshop-marketing-{hashcode}-{version}",
              "type": "Marketing",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.search_platform.shopInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "pc-"
          }
        }
      },
      "branches": [
        {
          "name": "sp_vip_yun_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"sys\":[02]"
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "fromSys": "sys\":(?P<fromSys>[\\d]+?)",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.pc.es.api.EsGoodsQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "query",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "fromSys": "{fromSys}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "product_vip",
              "operation": "create",
              "id": "{skuId}",
              "clear_policy": "every_msg,by_adminId",
              "tag": "vip"
            }
          ]
        },
        {
          "name": "sp_vip_spu_yun_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"sys\":[02]"
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "fromSys": "sys\":(?P<fromSys>[\\d]+?)",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.pc.es.api.EsProductQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "query",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "fromSys": "{fromSys}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "spu_vip",
              "operation": "create",
              "id": "{spuId}",
              "clear_policy": "every_msg,by_adminId",
              "tag": "vip"
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.marketing.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "marketing_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.api.search.SearchActivityQueryProvider",
            "request": {
              "method": "queryMarketingByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-{hashcode}-{version}",
              "type": "Marketing",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-{hashcode}-{version}",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "marketing_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "marketing-{hashcode}-{version}",
              "type": "Marketing",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "marketing-{hashcode}-{version}",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.marketing.itemChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "marketing_item_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.api.search.SearchActivityQueryProvider",
            "request": {
              "method": "queryItemByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-item-{hashcode}-{version}",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "marketing_item_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "marketing-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "marketing-item-{hashcode}-{version}",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.marketing.tradeChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "marketing_trade_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.api.search.SearchActivityQueryProvider",
            "request": {
              "method": "queryTradeMarketingRecordByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{tid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-trade-{hashcode}-{version}",
              "id": "{tid}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "marketing_trade_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "marketing-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "marketing-trade-{hashcode}-{version}",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.marketing.userCouponChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "marketing_usercoupon_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.api.search.SearchCouponQueryProvider",
            "request": {
              "method": "queryUserCouponByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-usercoupon-{hashcode}-{version}",
              "type": "Coupon",
              "id": "{couponId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-usercoupon-{hashcode}-{version}",
              "id": "{couponId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "marketing_usercoupon_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "marketing-usercoupon-{hashcode}-{version}",
              "type": "Coupon",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "marketing-usercoupon-{hashcode}-{version}",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.marketing.fansChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "marketing_fans_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.weixin.api.fans.SearchFansQueryProvider",
            "request": {
              "method": "queryFansByIds",
              "timeout": 8,
              "body": {
                "owner": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-fans-{hashcode}-{version}",
              "type": "Fans",
              "id": "{openId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-fans-{hashcode}-{version}",
              "id": "{openId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "marketing_fans_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "marketing-fans-{hashcode}-{version}",
              "type": "Fans",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "marketing-fans-{hashcode}-{version}",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.marketing.integralItem.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "marketing_integralItem_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.api.search.SearchIntegralItemQueryProvider",
            "request": {
              "method": "queryIntegralItemByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-integral-items-{hashcode}-{version}",
              "type": "Item",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-integral-items-{hashcode}-{version}",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "marketing_integralItem_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "marketing-integral-items-{hashcode}-{version}",
              "type": "Item",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "marketing-integral-items-{hashcode}-{version}",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.searchPlatform.marketingInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "marketing_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"marketing\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.api.search.SearchActivityQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryMarketing",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-{hashcode}-{version}",
              "type": "Marketing",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-{hashcode}-{version}",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "marketing_item_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"item\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.api.search.SearchActivityQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryItem",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-item-{hashcode}-{version}",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "marketing_trade_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"trade\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.api.search.SearchActivityQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryTradeMarketingRecord",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{tid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-trade-{hashcode}-{version}",
              "id": "{tid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "marketing_usercoupon_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"usercoupon\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.api.search.SearchCouponQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryUserCoupon",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-usercoupon-{hashcode}-{version}",
              "type": "Coupon",
              "id": "{couponId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-usercoupon-{hashcode}-{version}",
              "id": "{couponId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "marketing_fans_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"fans\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.weixin.api.fans.SearchFansQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryFans",
              "timeout": 8,
              "body": {
                "owner": "{adminId}",
                "msgId": "{msgId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-fans-{hashcode}-{version}",
              "type": "Fans",
              "id": "{openId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-fans-{hashcode}-{version}",
              "id": "{openId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "marketing_integralItem_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"integralitem\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.api.search.SearchIntegralItemQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryIntegralItems",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-integral-items-{hashcode}-{version}",
              "type": "Item",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-integral-items-{hashcode}-{version}",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "desc": "用户计次卡片数据初始化，负责人：张超珉",
          "name": "user_count_card_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"usercountcard\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.api.search.SearchCountCardQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryUserCountCard",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "mapping": {
                "_all": {
                  "store": false
                },
                "dynamic_templates": [
                  {
                    "string_fields": {
                      "mapping": {
                        "index": "not_analyzed",
                        "type": "string",
                        "fields": {
                          "analyzed": {
                            "index": "analyzed",
                            "analyzer": "qm_standard",
                            "type": "string"
                          }
                        }
                      },
                      "match_mapping_type": "string",
                      "match": "*"
                    }
                  },
                  {
                    "long_fields": {
                      "mapping": {
                        "type": "long",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "long",
                      "match": "*"
                    }
                  },
                  {
                    "double_fields": {
                      "mapping": {
                        "type": "double",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "double",
                      "match": "*"
                    }
                  }
                ],
                "properties": {
                  "userCardId": {
                    "type": "string",
                    "index": "not_analyzed",
                    "fields": {
                      "postfix": {
                        "type": "string",
                        "analyzer": "postfix"
                      }
                    }
                  },
                  "cardId": {
                    "type": "string",
                    "index": "not_analyzed",
                    "fields": {
                      "postfix": {
                        "type": "string",
                        "analyzer": "postfix"
                      }
                    }
                  },
                  "tid": {
                    "type": "string",
                    "index": "not_analyzed",
                    "fields": {
                      "postfix": {
                        "type": "string",
                        "analyzer": "postfix"
                      }
                    }
                  }
                }
              },
              "index": "user-count-card",
              "type": "Card",
              "id": "{userCardId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "user-count-card",
              "id": "{userCardId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.trade.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_trade_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.api.trade.search.TradeSearchQueryProvider",
            "request": {
              "method": "queryTradeByTid",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{tid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-trade-{hashcode}-{version}",
              "id": "{tid}",
              "add_admin_id_field": true
            },
            {
              "desc": "修改需要被反映到标准订单中",
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-standard-trade-{hashcode}-{version}-new",
              "type": "Trade",
              "id": "{tid}",
              "add_admin_id_field": true
            },
            {
              "desc": "修改需要被反映到标准订单中",
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-standard-trade-{hashcode}-{version}",
              "id": "{tid}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2c-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2c-trade-{hashcode}-{version}",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2c-standard-trade-{hashcode}-{version}-new",
              "type": "Trade",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2c-standard-trade-{hashcode}-{version}",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.itemOrder.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_trade_item_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.api.trade.search.TradeSearchQueryProvider",
            "request": {
              "method": "queryItemOrderByOid",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-trade-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{oid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-trade-item-{hashcode}-{version}",
              "id": "{oid}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_item_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2c-trade-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{oid}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2c-trade-item-{hashcode}-{version}",
              "id": "{oid}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.trade.applyChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_trade_application_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.api.apply.search.Apply4SearchQueryProvider",
            "request": {
              "method": "queryApplyListByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-trade-application-{hashcode}-{version}",
              "type": "Application",
              "id": "{applyId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-trade-application-{hashcode}-{version}",
              "id": "{applyId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-standard-trade-application-{hashcode}-{version}",
              "type": "Application",
              "id": "{applyId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-standard-trade-application-{hashcode}-{version}",
              "id": "{applyId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_application_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2c-trade-application-{hashcode}-{version}",
              "type": "Application",
              "id": "{applyId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2c-trade-application-{hashcode}-{version}",
              "id": "{applyId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2c-standard-trade-application-{hashcode}-{version}",
              "type": "Application",
              "id": "{applyId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2c-standard-trade-application-{hashcode}-{version}",
              "id": "{applyId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.trade.refundReceiptChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_trade_refunded_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.api.receipt.search.Receipt4SearchQueryProvider",
            "request": {
              "method": "queryRefundReceiptListByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-trade-refunded-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-trade-refunded-{hashcode}-{version}",
              "id": "{receiptId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_refunded_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2c-trade-refunded-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2c-trade-refunded-{hashcode}-{version}",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.trade.returnReceiptChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_trade_returned_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.api.receipt.search.Receipt4SearchQueryProvider",
            "request": {
              "method": "queryReturnReceiptListByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-trade-returned-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-trade-returned-{hashcode}-{version}",
              "id": "{receiptId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_returned_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2c-trade-returned-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2c-trade-returned-{hashcode}-{version}",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.trade.shipReceiptChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_trade_ship_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.api.receipt.search.Receipt4SearchQueryProvider",
            "request": {
              "method": "queryShipReceiptListByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-trade-ship-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-trade-ship-{hashcode}-{version}",
              "id": "{receiptId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_ship_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2c-trade-ship-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2c-trade-ship-{hashcode}-{version}",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.trade.receiveReceiptChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_trade_receive_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.api.receipt.search.Receipt4SearchQueryProvider",
            "request": {
              "method": "queryReceiveReceiptListByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-trade-receive-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-trade-receive-{hashcode}-{version}",
              "id": "{receiptId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_receive_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2c-trade-receive-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2c-trade-receive-{hashcode}-{version}",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.searchPlatform.d2c.tradeInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          }
        }
      },
      "branches": [
        {
          "name": "d2c_trade_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"trade\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.api.trade.search.TradeSearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryTradePage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{tid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-trade-{hashcode}-{version}",
              "id": "{tid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "desc": "同时把商城订单数据初始化到标准订单的索引中",
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-standard-trade-{hashcode}-{version}-new",
              "type": "Trade",
              "id": "{tid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "desc": "同时把商城订单数据初始化到标准订单的索引中",
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-standard-trade-{hashcode}-{version}",
              "id": "{tid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_cash_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"trade\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryTradePage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "desc": "这里把收银订单的数据初始化到标准订单中，收银订单本身数据的初始化在q.searchPlatform.d2c.cash.tradeInit中",
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-standard-trade-{hashcode}-{version}-new",
              "type": "Trade",
              "id": "{tid}",
              "add_admin_id_field": true
            },
            {
              "desc": "这里把收银订单的数据初始化到标准订单中，收银订单本身数据的初始化在q.searchPlatform.d2c.cash.tradeInit中",
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-standard-trade-{hashcode}-{version}",
              "id": "{tid}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_item_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"item_order\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.api.trade.search.TradeSearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryItemOrderPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-trade-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{oid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-trade-item-{hashcode}-{version}",
              "id": "{oid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_application_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"apply\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.api.apply.search.Apply4SearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryApplyPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-trade-application-{hashcode}-{version}",
              "type": "Application",
              "id": "{applyId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-trade-application-{hashcode}-{version}",
              "id": "{applyId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "desc": "售后单的数据也需要初始化到标准售后单订单中",
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-standard-trade-application-{hashcode}-{version}",
              "type": "Application",
              "id": "{applyId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "desc": "售后单的数据也需要初始化到标准售后单订单中",
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-standard-trade-application-{hashcode}-{version}",
              "id": "{applyId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_cash_trade_application_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"apply\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryApplyPage",
              "timeout": 8,
              "body": {
                "clientIp": "127.0.0.1",
                "clientDeviceType": "SELLER_CASH_IPAD",
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "desc": "收银售后单只需要被初始化到标准售后单索引中，不需要单独存在",
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-standard-trade-application-{hashcode}-{version}",
              "type": "Application",
              "id": "{refundReceiptId}",
              "add_admin_id_field": true
            },
            {
              "desc": "收银售后单只需要被初始化到标准售后单索引中，不需要单独存在",
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-standard-trade-application-{hashcode}-{version}",
              "id": "{refundReceiptId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_refunded_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"refund_receipt\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.api.receipt.search.Receipt4SearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryRefundReceiptPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-trade-refunded-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-trade-refunded-{hashcode}-{version}",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_returned_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"return_receipt\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.api.receipt.search.Receipt4SearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryReturnReceiptPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-trade-returned-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-trade-returned-{hashcode}-{version}",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_receive_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"receive_receipt\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.api.receipt.search.Receipt4SearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryReceiveReceiptPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-trade-receive-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-trade-receive-{hashcode}-{version}",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_ship_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"ship_receipt\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.api.receipt.search.Receipt4SearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryShipReceiptPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-trade-ship-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-trade-ship-{hashcode}-{version}",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.cash.trade.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_cash_trade_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "request": {
              "method": "queryTradeByTids",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-cash-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{tid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-cash-trade-{hashcode}-{version}",
              "id": "{tid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-standard-trade-{hashcode}-{version}-new",
              "type": "Trade",
              "id": "{tid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-standard-trade-{hashcode}-{version}",
              "id": "{tid}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2c-cash-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{tid}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2c-cash-trade-{hashcode}-{version}",
              "id": "{tid}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2c-standard-trade-{hashcode}-{version}-new",
              "type": "Trade",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2c-standard-trade-{hashcode}-{version}",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.cash.itemOrder.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_cash_trade_item_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "request": {
              "method": "queryItemOrderByOids",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-cash-trade-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{oid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-cash-trade-item-{hashcode}-{version}",
              "id": "{oid}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_cash_trade_item_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2c-cash-trade-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{oid}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2c-cash-trade-item-{hashcode}-{version}",
              "id": "{oid}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.cash.returnReceipt.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_cash_trade_returnReceipt_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "request": {
              "method": "queryReturnReceiptListByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-cash-trade-returned-{hashcode}-{version}",
              "type": "Item",
              "id": "{retTid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-cash-trade-returned-{hashcode}-{version}",
              "id": "{retTid}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_cash_trade_returnReceipt_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2c-cash-trade-returned-{hashcode}-{version}",
              "type": "Item",
              "id": "{retTid}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2c-cash-trade-returned-{hashcode}-{version}",
              "id": "{retTid}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.cash.refundReceipt.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_cash_trade_refundReceipt_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "request": {
              "method": "queryRefundReceiptListByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-cash-trade-refunded-{hashcode}-{version}",
              "type": "Item",
              "id": "{receiptId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-cash-trade-refunded-{hashcode}-{version}",
              "id": "{receiptId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_cash_trade_refundReceipt_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2c-cash-trade-refunded-{hashcode}-{version}",
              "type": "Item",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2c-cash-trade-refunded-{hashcode}-{version}",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.searchPlatform.d2c.cash.tradeInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          }
        }
      },
      "branches": [
        {
          "name": "d2c_trade_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"trade\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryTradePage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-cash-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{tid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-cash-trade-{hashcode}-{version}",
              "id": "{tid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_trade_item_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"item_order\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryItemOrderPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-cash-trade-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{oid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-cash-trade-item-{hashcode}-{version}",
              "id": "{oid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_cash_trade_return_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"return_receipt\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryReturnReceiptPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-cash-trade-returned-{hashcode}-{version}",
              "type": "Item",
              "id": "{retTid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-cash-trade-returned-{hashcode}-{version}",
              "id": "{retTid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_cash_trade_refundReceipt_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"refund_receipt\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryRefundReceiptPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-cash-trade-refunded-{hashcode}-{version}",
              "type": "Item",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-cash-trade-refunded-{hashcode}-{version}",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2p.order.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2p_trade_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2p.order.api.TradeQueryProvider",
            "request": {
              "method": "findByIds",
              "timeout": 8,
              "body": {
                "ids": "{ids}",
                "msgId": "{msgId}",
                "adminId": "{adminId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2p-trade-{hashcode}-{version}-new",
              "type": "Trade",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2p-trade-{hashcode}-{version}",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2p_trade_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2p-trade-{hashcode}-{version}-new",
              "type": "Trade",
              "id": "{id}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2p-trade-{hashcode}-{version}",
              "id": "{id}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.searchPlatform.d2p.returnInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          }
        }
      },
      "branches": [
        {
          "name": "d2p_trade_return_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": []
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2p.returnorder.api.ReturnOrderQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "findByAdminId",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "msgId": "{msgId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2p-trade-returned-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2p-trade-returned-{hashcode}-{version}",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2p.order.return.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2p_trade_return_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2p.returnorder.api.ReturnOrderQueryProvider",
            "request": {
              "method": "findByIds",
              "timeout": 8,
              "body": {
                "msgId": "{msgId}",
                "adminId": "{adminId}",
                "ids": "{ids}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2p-trade-returned-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2p-trade-returned-{hashcode}-{version}",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2p_trade_return_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2p-trade-returned-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{id}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2p-trade-returned-{hashcode}-{version}",
              "id": "{id}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.searchPlatform.d2p.tradeInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          }
        }
      },
      "branches": [
        {
          "name": "d2p_trade_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": []
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2p.order.api.TradeQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "findByAdminId",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2p-trade-{hashcode}-{version}-new",
              "type": "Trade",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2p-trade-{hashcode}-{version}",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.consignment.trade.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "consignment_trade_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.consignment.api.trade.search.TradeSearchQueryProvider",
            "request": {
              "method": "queryTradeByTid",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "consignment-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{tid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "consignment-trade-{hashcode}-{version}",
              "id": "{tid}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "consignment_trade_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "consignment-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{tid}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "consignment-trade-{hashcode}-{version}",
              "id": "{tid}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.consignment.itemOrder.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "consignment_trade_item_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.consignment.api.trade.search.TradeSearchQueryProvider",
            "request": {
              "method": "queryItemOrderByOid",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "consignment-trade-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{oid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "consignment-trade-item-{hashcode}-{version}",
              "id": "{oid}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "consignment_trade_item_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "consignment-trade-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{oid}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "consignment-trade-item-{hashcode}-{version}",
              "id": "{oid}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.consignment.trade.applyChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "consignment_trade_application_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.consignment.api.apply.search.Apply4SearchQueryProvider",
            "request": {
              "method": "queryApplyListByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "consignment-trade-application-{hashcode}-{version}",
              "type": "Application",
              "id": "{applyId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "consignment-trade-application-{hashcode}-{version}",
              "id": "{applyId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "consignment_trade_application_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "consignment-trade-application-{hashcode}-{version}",
              "type": "Application",
              "id": "{applyId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "consignment-trade-application-{hashcode}-{version}",
              "id": "{applyId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.consignment.trade.refundReceiptChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "consignment_trade_refunded_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.consignment.api.receipt.search.Receipt4SearchQueryProvider",
            "request": {
              "method": "queryRefundReceiptListByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "consignment-trade-refunded-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "consignment_trade_refunded_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "consignment-trade-refunded-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.consignment.trade.returnReceiptChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "consignment_trade_returned_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.consignment.api.receipt.search.Receipt4SearchQueryProvider",
            "request": {
              "method": "queryReturnReceiptListByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "consignment-trade-returned-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "consignment_trade_returned_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "consignment-trade-returned-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.consignment.trade.shipReceiptChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "consignment_trade_ship_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.consignment.api.receipt.search.Receipt4SearchQueryProvider",
            "request": {
              "method": "queryShipReceiptListByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "consignment-trade-ship-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "consignment-trade-ship-{hashcode}-{version}",
              "id": "{receiptId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "consignment_trade_ship_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "consignment-trade-ship-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "consignment-trade-ship-{hashcode}-{version}",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.consignment.trade.receiveReceiptChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "consignment_trade_receive_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.consignment.api.receipt.search.Receipt4SearchQueryProvider",
            "request": {
              "method": "queryReceiveReceiptListByIds",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "consignment-trade-receive-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "consignment-trade-receive-{hashcode}-{version}",
              "id": "{receiptId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "consignment_trade_receive_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "consignment-trade-receive-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "consignment-trade-receive-{hashcode}-{version}",
              "id": "{receiptId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.searchPlatform.consignment.tradeInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          }
        }
      },
      "branches": [
        {
          "name": "consignment_trade_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"trade\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.consignment.api.trade.search.TradeSearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryTradePage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "consignment-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{tid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "consignment-trade-{hashcode}-{version}",
              "id": "{tid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "consignment_trade_item_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"item_order\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.consignment.api.trade.search.TradeSearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryItemOrderPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "consignment-trade-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{oid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "consignment-trade-item-{hashcode}-{version}",
              "id": "{oid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "consignment_trade_application_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"apply\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.consignment.api.apply.search.Apply4SearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryApplyPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "consignment-trade-application-{hashcode}-{version}",
              "type": "Application",
              "id": "{applyId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "consignment-trade-application-{hashcode}-{version}",
              "id": "{applyId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "consignment_trade_refunded_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"refund_receipt\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.consignment.api.receipt.search.Receipt4SearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryRefundReceiptPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "consignment-trade-refunded-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "consignment_trade_returned_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"return_receipt\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.consignment.api.receipt.search.Receipt4SearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryReturnReceiptPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "consignment-trade-returned-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "consignment_trade_receive_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"receive_receipt\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.consignment.api.receipt.search.Receipt4SearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryReceiveReceiptPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "consignment-trade-receive-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "consignment-trade-receive-{hashcode}-{version}",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "consignment_trade_ship_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"ship_receipt\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.consignment.api.receipt.search.Receipt4SearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryShipReceiptPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "consignment-trade-ship-{hashcode}-{version}",
              "type": "Receipt",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "consignment-trade-ship-{hashcode}-{version}",
              "id": "{receiptId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.usercenter.es.ticketChange",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc"
            }
          }
        }
      },
      "branches": [
        {
          "name": "usercenter_ticket_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "ticketId": "ticketId\":\"(?P<ticketId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.uc.query.api.ticket.search.QueryTicket4SearchProvider",
            "request": {
              "method": "getTicketById4Search",
              "timeout": 8,
              "body": {
                "msgId": "{msgId}",
                "ticketId": "{ticketId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "qm-user-{version}",
              "type": "User",
              "id": "{ticketId}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "qm-user-{version}",
              "id": "{ticketId}"
            }
          ]
        },
        {
          "name": "usercenter_ticket_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ticketId": "ticketId\":\"(?P<ticketId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "qm-user-{version}",
              "type": "User",
              "id": "{ticketId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "qm-user-{version}",
              "id": "{ticketId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.usercenter.es.storeChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "usercenter_shop_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.uc.query.api.store.search.QueryStore4SearchProvider",
            "request": {
              "method": "getStoreById4Search",
              "timeout": 8,
              "body": {
                "msgId": "{msgId}",
                "adminId": "{adminId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "qm-usershop-{version}",
              "type": "Shop",
              "id": "{adminId}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "qm-usershop-{version}",
              "id": "{adminId}"
            }
          ]
        },
        {
          "name": "usercenter_shop_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "qm-usershop-{version}",
              "type": "Shop",
              "id": "{adminId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "qm-usershop-{version}",
              "id": "{adminId}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.usercenter.ticketInit",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc"
            }
          }
        }
      },
      "branches": [
        {
          "name": "usercenter_ticket_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": []
            },
            "data_parser": {
              "type": "regex",
              "fields": {}
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.uc.query.api.ticket.search.QueryTicket4SearchProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryAllTickets4Search",
              "timeout": 8,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "qm-user-{version}",
              "type": "User",
              "id": "{ticketId}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "qm-user-{version}",
              "id": "{ticketId}"
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.usercenter.shopInit",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc"
            }
          }
        }
      },
      "branches": [
        {
          "name": "usercenter_shop_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": []
            },
            "data_parser": {
              "type": "regex",
              "fields": {}
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.uc.query.api.store.search.QueryStore4SearchProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryAllStores4Search",
              "timeout": 8,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "qm-usershop-{version}",
              "type": "Shop",
              "id": "{adminId}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "qm-usershop-{version}",
              "id": "{adminId}"
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.oms.searchPlatform.deliveryNote.change",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "oms"
            }
          }
        }
      },
      "branches": [
        {
          "name": "oms_delivery_note_change",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMaster\":\"(?P<adminId>[\\d\\D]+?)\"",
                "deliveryNos": "deliveryNos\":\"(?P<deliveryNos>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.oms.api.delivery.DeliveryNoteViewProvider",
            "request": {
              "method": "findByDeliveryNos",
              "timeout": 8,
              "body": {
                "chainMaster": "{adminId}",
                "deliveryNos": "{deliveryNos}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "qm-oms-{hashcode}-{version}",
              "type": "DeliveryNote",
              "id": "{deliveryNo}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "qm-oms-{hashcode}-{version}",
              "id": "{deliveryNo}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "oms_delivery_note_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMaster\":\"(?P<adminId>[\\d\\D]+?)\"",
                "deliveryNos": "deliveryNos\":\"(?P<deliveryNos>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "qm-oms-{hashcode}-{version}",
              "type": "DeliveryNote",
              "id": "{deliveryNos}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "qm-oms-{hashcode}-{version}",
              "id": "{deliveryNos}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.oms.searchPlatform.deliveryNote.init",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "oms"
            }
          }
        }
      },
      "branches": [
        {
          "name": "oms_delivery_note_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"init\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMaster\":\"(?P<adminId>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.oms.api.delivery.DeliveryNoteViewProvider",
            "version": "1.0.0",
            "request": {
              "method": "findByChainMaster",
              "timeout": 8,
              "body": {
                "chainMaster": "{adminId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "qm-oms-{hashcode}-{version}",
              "type": "DeliveryNote",
              "id": "{deliveryNo}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "qm-oms-{hashcode}-{version}",
              "id": "{deliveryNo}",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.usercenter.visitPlanChange",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc_visit_plan"
            }
          }
        }
      },
      "branches": [
        {
          "name": "uc_visit_plan_change",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "planId": "planId\":\"(?P<planId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.uc.vrecord.api.plan.search.VisitPlanQuery4SearchProvider",
            "request": {
              "method": "getById4Search",
              "timeout": 8,
              "body": {
                "planId": "{planId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "qm-uc-{version}",
              "type": "Plan",
              "id": "{planId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "qm-uc-plan-{version}",
              "id": "{planId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "uc_visit_plan_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "fields": {
                  "planId": "planId\":\"(?P<planId>[\\d\\D]+?)\""
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "qm-uc-{version}",
              "type": "Plan",
              "id": "{planId}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "qm-uc-plan-{version}",
              "id": "{planId}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.usercenter.visitRecordChange",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc_visit_record"
            }
          }
        }
      },
      "branches": [
        {
          "name": "uc_visit_record_change",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "recordId": "recordId\":\"(?P<recordId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.uc.vrecord.api.record.search.VisitRecordQuery4SearchProvider",
            "request": {
              "method": "getById4Search",
              "timeout": 8,
              "body": {
                "recordId": "{recordId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "qm-uc-{version}",
              "type": "Record",
              "id": "{recordId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "qm-uc-record-{version}",
              "id": "{recordId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "uc_visit_record_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "fields": {
                  "recordId": "recordId\":\"(?P<recordId>[\\d\\D]+?)\""
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "qm-uc-{version}",
              "type": "Record",
              "id": "{recordId}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "qm-uc-record-{version}",
              "id": "{recordId}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.usercenter.visitPlanInit",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc_visit_plan"
            }
          }
        }
      },
      "branches": [
        {
          "name": "uc_visit_plan_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.uc.vrecord.api.plan.search.VisitPlanQuery4SearchProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryAllVisitPlan4Search",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "qm-uc-{version}",
              "type": "Plan",
              "id": "{planId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "qm-uc-plan-{version}",
              "id": "{planId}",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.usercenter.visitRecordInit",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc_visit_record"
            }
          }
        }
      },
      "branches": [
        {
          "name": "uc_visit_record_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.uc.vrecord.api.record.search.VisitRecordQuery4SearchProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryAllVisitRecord4Search",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "qm-uc-{version}",
              "type": "Record",
              "id": "{recordId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "qm-uc-record-{version}",
              "id": "{recordId}",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.usercenter.es.employeeChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "uc_employee_change",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "employeeId": "employeeId\":\"(?P<employeeId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.uc.query.api.employee.search.QueryEmployee4SearchProvider",
            "request": {
              "method": "listEmployeeById",
              "timeout": 8,
              "body": {
                "msgId": "{msgId}",
                "employeeId": "{employeeId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "qm-uc-employee-{version}",
              "type": "Employee",
              "id": "{employeeId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "qm-uc-employee-{version}",
              "id": "{employeeId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "uc_employee_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "employeeId": "employeeId\":\"(?P<employeeId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "qm-uc-employee-{version}",
              "type": "Employee",
              "id": "{employeeId}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "qm-uc-employee-{version}",
              "id": "{employeeId}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.usercenter.syncEmployee",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "shopId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "uc_employee_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "shopId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.uc.query.api.employee.search.QueryEmployee4SearchProvider",
            "version": "1.0.0",
            "request": {
              "method": "listEmployeeByAdminId",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "qm-uc-employee-{version}",
              "type": "Employee",
              "id": "{employeeId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "qm-uc-employee-{version}",
              "id": "{employeeId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.qmselforder.search.partner_customer",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "uc_partner_customer_change",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "customerId": "customerId\":\"(?P<customerId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0",
            "service_interface": "com.qianmi.self.order.query.PartnerEsQueryProvider",
            "request": {
              "method": "customerById",
              "timeout": 8,
              "body": {
                "customerId": "{customerId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "qm-uc-partner-customer-{version}",
              "type": "PartnerCustomer",
              "id": "{customerQmId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "uc_partner_customer_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "customerId": "customerId\":\"(?P<customerId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "operation": "delete",
              "index": "qm-uc-partner-customer-{version}",
              "type": "PartnerCustomer",
              "id": "{customerId}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.qmselforder.search.partner_customer_page",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "uc_partner_customer_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.self.order.query.PartnerEsQueryProvider",
            "version": "1.0",
            "request": {
              "method": "customerByPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "qm-uc-partner-customer-{version}",
              "type": "PartnerCustomer",
              "id": "{customerQmId}",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.searchPlatform.d2c.cart.cartInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "d2c_cart_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.cart.api.buyer.BuyerCartQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryPage4Search",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "msgId": "{msgId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "qm-d2c-cart-{version}",
              "type": "Cart",
              "id": "{userId}",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.searchPlatform.d2c.cart.footprintInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "d2c_cart_footprint_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.cart.api.buyer.BuyerFootprintQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryPage4Search",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "msgId": "{msgId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "qm-d2c-cart-footprint-{version}",
              "type": "CartFootprint",
              "id": "{userId}",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.searchPlatform.d2c.cart.favouriteInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "d2c_cart_favourite_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.cart.api.buyer.BuyerFavouriteQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryPage4Search",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "msgId": "{msgId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "qm-d2c-cart-favourite-{version}",
              "type": "CartFavourite",
              "id": "{userId}",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.cart.cartChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "d2c_card_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"update\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "userId": "userId\":\"(?P<userId>[\\d\\D]+?)\"",
                "levelId": "levelId\":\"(?P<levelId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.cart.api.buyer.BuyerCartQueryProvider",
            "request": {
              "method": "query4Search",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "domainType": "{domainType}",
                "userId": "{userId}",
                "levelId": "{levelId}",
                "msgId": "{msgId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "qm-d2c-cart-{version}",
              "type": "Cart",
              "id": "{userId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_card_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "userId": "userId\":\"(?P<userId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "operation": "delete",
              "index": "qm-d2c-cart-{version}",
              "type": "Cart",
              "id": "{userId}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.cart.footprintChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "d2c_card_footprint_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"update\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "userId": "userId\":\"(?P<userId>[\\d\\D]+?)\"",
                "levelId": "levelId\":\"(?P<levelId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.cart.api.buyer.BuyerFootprintQueryProvider",
            "request": {
              "method": "query4Search",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "domainType": "{domainType}",
                "userId": "{userId}",
                "levelId": "{levelId}",
                "msgId": "{msgId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "qm-d2c-cart-footprint-{version}",
              "type": "CartFootprint",
              "id": "{userId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_card_footprint_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "userId": "userId\":\"(?P<userId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "operation": "delete",
              "index": "qm-d2c-cart-footprint-{version}",
              "type": "CartFootprint",
              "id": "{userId}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.cart.favouriteChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "d2c_card_favourite_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"update\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "userId": "userId\":\"(?P<userId>[\\d\\D]+?)\"",
                "levelId": "levelId\":\"(?P<levelId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.cart.api.buyer.BuyerFavouriteQueryProvider",
            "request": {
              "method": "query4Search",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "domainType": "{domainType}",
                "userId": "{userId}",
                "levelId": "{levelId}",
                "msgId": "{msgId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "qm-d2c-cart-favourite-{version}",
              "type": "CartFavourite",
              "id": "{userId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_card_favourite_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "userId": "userId\":\"(?P<userId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "operation": "delete",
              "index": "qm-d2c-cart-favourite-{version}",
              "type": "CartFavourite",
              "id": "{userId}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.uc.retail.init",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "storeId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "b2c_uc_retail_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "storeId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "mqId": "mqId\":\"(?P<mqId>[\\d\\D]+?)\"",
                "storeId": "storeId\":\"(?P<storeId>[\\d\\D]+?)\"",
                "storeType": "storeType\":\"(?P<storeType>[\\d\\D]+?)\"",
                "uuid": "uuid\":\"(?P<uuid>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.uc.connection.api.view.search.ConnectionSearchProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryB2cByPage",
              "timeout": 8,
              "body": {
                "clientIp": "127.0.0.1",
                "clientType": "SEARCH_PLATFORM",
                "mqId": "{mqId}",
                "storeId": "{storeId}",
                "storeType": "{storeType}",
                "uuid": "{uuid}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "b2c-retail-view-{version}",
              "type": "B2CRetailView",
              "add_admin_id_field": true,
              "clear_policy": "every_msg,by_adminId",
              "id": "{cid}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "b2c-retail-view-{version}",
              "add_admin_id_field": true,
              "clear_policy": "every_msg,by_adminId",
              "id": "{cid}"
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.uc.retail.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "storeId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "b2c_retail_view_change",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "storeId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "mqId": "mqId\":\"(?P<mqId>[\\d\\D]+?)\"",
                "storeId": "storeId\":\"(?P<storeId>[\\d\\D]+?)\"",
                "storeType": "storeType\":\"(?P<storeType>[\\d\\D]+?)\"",
                "cids": "cids\":\"(?P<cids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.uc.connection.api.view.search.ConnectionSearchProvider",
            "request": {
              "method": "queryB2cByCids",
              "timeout": 8,
              "body": {
                "clientIp": "127.0.0.1",
                "clientType": "SEARCH_PLATFORM",
                "ids": "{cids}",
                "mqId": "{mqId}",
                "storeId": "{storeId}",
                "storeType": "{storeType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "b2c-retail-view-{version}",
              "type": "B2CRetailView",
              "add_admin_id_field": true,
              "id": "{cid}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "b2c-retail-view-{version}",
              "add_admin_id_field": true,
              "id": "{cid}"
            }
          ]
        },
        {
          "name": "b2c_retail_view_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "cids": "cids\":\"(?P<cids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "b2c-retail-view-{version}",
              "type": "B2CRetailView",
              "operation": "delete",
              "id": "{cids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "b2c-retail-view-{version}",
              "operation": "delete",
              "id": "{cids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.usercenter.es.storeExpire",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc"
            }
          }
        }
      },
      "branches": [
        {
          "name": "usercenter_shop_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.uc.query.api.store.search.QueryStore4SearchProvider",
            "request": {
              "method": "listByIds4Search",
              "timeout": 8,
              "body": {
                "msgId": "{msgId}",
                "adminId": "{adminId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "qm-usershop-{version}",
              "type": "Shop",
              "id": "{adminId}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "qm-usershop-{version}",
              "id": "{adminId}"
            }
          ]
        },
        {
          "name": "usercenter_shop_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "qm-usershop-{version}",
              "type": "Shop",
              "id": "{adminId}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "qm-usershop-{version}",
              "id": "{adminId}",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2c.cash.apply.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          }
        }
      },
      "branches": [
        {
          "name": "d2c_cash_apply_change",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "request": {
              "method": "queryApplyListByIds",
              "timeout": 8,
              "body": {
                "msgId": "{msgId}",
                "adminId": "{adminId}",
                "ids": "{ids}",
                "clientDeviceType": "SELLER_CASH_IPAD",
                "clientIp": "127.0.0.1"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-standard-trade-application-{hashcode}-{version}",
              "type": "Application",
              "id": "{refundReceiptId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-standard-trade-application-{hashcode}-{version}",
              "id": "{refundReceiptId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2c_cash_apply_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-standard-trade-application-{hashcode}-{version}",
              "type": "Application",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-standard-trade-application-{hashcode}-{version}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.tms.searchPlatform.shippingOrder.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "chainMaster\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "trade-"
          }
        }
      },
      "branches": [
        {
          "name": "tms_view_change",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "deliverType": "deliverType\":\"(?P<deliverType>[\\d\\D]+?)\"",
                "adminId": "chainMaster\":\"(?P<adminId>[\\d\\D]+?)\"",
                "no": "no\":\"(?P<no>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.tms.view.ShippingOrderViewProvider",
            "request": {
              "method": "findByNo",
              "timeout": 30,
              "body": {
                "deliverType": "{deliverType}",
                "chainMaster": "{adminId}",
                "no": "{no}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "tms-view-{version}",
              "type": "View",
              "id": "{no}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "tms-view-{version}",
              "id": "{no}",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.admin_micro_order.search.sys_order.one",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "sys_order"
            }
          }
        }
      },
      "branches": [
        {
          "name": "system_order_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "orderNo": "orderNo\":\"(?P<orderNo>[\\d\\D]+?)\"",
                "userNo": "userNo\":\"(?P<userNo>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0",
            "service_interface": "com.qianmi.admin.order.api.boss.OrderEsQueryProvider",
            "request": {
              "method": "getOrderInfoByOIdAndUId",
              "timeout": 30,
              "body": {
                "orderNo": "{orderNo}",
                "userNo": "{userNo}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "qm-system-order-{version}",
              "type": "Order",
              "id": "{orderNo}"
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.admin_micro_order.search.sys_order.page",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "sys_order"
            }
          }
        }
      },
      "branches": [
        {
          "name": "system_order_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {}
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.admin.order.api.boss.OrderEsQueryProvider",
            "version": "1.0",
            "request": {
              "method": "getOrderInfoPage",
              "timeout": 30,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "qm-system-order-{version}",
              "type": "Order",
              "id": "{orderNo}",
              "clear_policy": "every_msg,all"
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.purchase.es.purchaserSkuInit",
        "desc": "初始化商品中心位于多个仓库的商品",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "pc-"
          }
        }
      },
      "branches": [
        {
          "name": "purchaser_sku_init_0",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.gcs.purchase.view.api.EsPurchaseViewQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "query",
              "timeout": 30,
              "body": {
                "chainMasterId": "{adminId}",
                "initType": "0",
                "msgId": "{msgId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "qmshop-purchaser-sku-new",
              "type": "Sku",
              "add_admin_id_field": true,
              "clear_policy": "every_msg,by_adminId",
              "id": "{id}"
            }
          ]
        },
        {
          "name": "purchaser_sku_init_1",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.gcs.purchase.view.api.EsPurchaseViewQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "query",
              "timeout": 30,
              "body": {
                "chainMasterId": "{adminId}",
                "initType": "1",
                "msgId": "{msgId}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "qmshop-purchaser-sku-new",
              "type": "Sku",
              "add_admin_id_field": true,
              "id": "{id}"
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.purchase.es.purchaserSku",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "pc-"
          }
        }
      },
      "branches": [
        {
          "name": "purchaser_sku_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.gcs.purchase.view.api.EsPurchaseViewQueryProvider",
            "request": {
              "method": "listByIds",
              "timeout": 30,
              "body": {
                "msgId": "{msgId}",
                "chainMasterId": "{adminId}",
                "ids": "{ids}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "qmshop-purchaser-sku-new",
              "type": "Sku",
              "add_admin_id_field": true,
              "id": "{id}"
            }
          ]
        },
        {
          "name": "purchaser_sku_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "qmshop-purchaser-sku-new",
              "type": "Sku",
              "operation": "delete",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ":"
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "大订单视图的初始化操作",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.searchPlatform.view.trade.init",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "desc": "商城订单的初始化",
          "name": "d2c_trade_view_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"trade\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.trade.view.api.TradeViewQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryByPage",
              "timeout": 25,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "scene": "onlineMall",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "trade_tid_wildcard_vip",
              "operation": "create",
              "index": "view-retail-trades-new",
              "type": "Trade",
              "id": "{tid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "view-retail-trades",
              "id": "{tid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "desc": "收银订单的初始化",
          "name": "cash_trade_view_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"trade\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.trade.view.api.TradeViewQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryByPage",
              "timeout": 25,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "scene": "cloudShop",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "trade_tid_wildcard_vip",
              "operation": "create",
              "index": "view-retail-trades-new",
              "type": "Trade",
              "id": "{tid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "view-retail-trades",
              "id": "{tid}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "desc": "京东到家订单的初始化",
          "name": "jddaojia_trade_view_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"trade\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.trade.view.api.TradeViewQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryByPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "scene": "jddaojia",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "trade_tid_wildcard_vip",
              "operation": "create",
              "index": "view-retail-trades-new",
              "type": "Trade",
              "id": "{tid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "view-retail-trades",
              "id": "{tid}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "desc": "美团订单的初始化",
          "name": "meituan_trade_view_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"trade\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.trade.view.api.TradeViewQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryByPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "scene": "meituan",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "trade_tid_wildcard_vip",
              "operation": "create",
              "index": "view-retail-trades-new",
              "type": "Trade",
              "id": "{tid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "view-retail-trades",
              "id": "{tid}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "desc": "商城申请单的初始化",
          "name": "d2c_trade_apply_view_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"apply\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.trade.view.api.ApplyViewQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryByPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "scene": "onlineMall",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "trade_apply_tid_wildcard_vip",
              "operation": "create",
              "index": "view-retail-trades-applies",
              "type": "Trade",
              "id": "{applyId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "view-retail-trades-applies",
              "id": "{applyId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "desc": "收银申请单的初始化",
          "name": "cash_trade_apply_view_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"apply\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.trade.view.api.ApplyViewQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryByPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "scene": "cloudShop",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "trade_apply_tid_wildcard_vip",
              "operation": "create",
              "index": "view-retail-trades-applies",
              "type": "Trade",
              "id": "{applyId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "view-retail-trades-applies",
              "id": "{applyId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "desc": "京东到家申请单的初始化",
          "name": "jddaojia_trade_apply_view_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"apply\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.trade.view.api.ApplyViewQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryByPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "scene": "jddaojia",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "trade_apply_tid_wildcard_vip",
              "operation": "create",
              "index": "view-retail-trades-applies",
              "type": "Trade",
              "id": "{applyId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "view-retail-trades-applies",
              "id": "{applyId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "desc": "美团申请单的初始化",
          "name": "meituan_trade_apply_view_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"apply\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.trade.view.api.ApplyViewQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryByPage",
              "timeout": 8,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "scene": "meituan",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "trade_apply_tid_wildcard_vip",
              "operation": "create",
              "index": "view-retail-trades-applies",
              "type": "Trade",
              "id": "{applyId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "view-retail-trades-applies",
              "id": "{applyId}",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "大订单视图的数据变更操作",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.view.trade.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "trade_view_change",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.trade.view.api.TradeViewQueryProvider",
            "request": {
              "method": "queryByIds",
              "timeout": 8,
              "body": {
                "msgId": "{msgId}",
                "adminId": "{adminId}",
                "ids": "{ids}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "trade_tid_wildcard_vip",
              "index": "view-retail-trades-new",
              "type": "Trade",
              "add_admin_id_field": true,
              "id": "{tid}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "view-retail-trades",
              "add_admin_id_field": true,
              "id": "{tid}"
            }
          ]
        }
      ]
    },
    {
      "desc": "大订单申请单视图的数据变更操作",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.view.trade.apply.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "trade_apply_view_change",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.trade.view.api.ApplyViewQueryProvider",
            "request": {
              "method": "queryByIds",
              "timeout": 8,
              "body": {
                "msgId": "{msgId}",
                "adminId": "{adminId}",
                "ids": "{ids}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "trade_apply_tid_wildcard_vip",
              "index": "view-retail-trades-applies",
              "type": "Trade",
              "add_admin_id_field": true,
              "id": "{applyId}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "view-retail-trades-applies",
              "add_admin_id_field": true,
              "id": "{applyId}"
            }
          ]
        }
      ]
    },
    {
      "desc": "连接大视图的数据变更操作，负责人：沈春南",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.uc.connection.grandview.change",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "default"
            }
          }
        }
      },
      "branches": [
        {
          "name": "b2c_connection_grandview_change",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.uc.connection.grandview.api.dubbo.EsQueryProvider",
            "request": {
              "method": "findByCids",
              "timeout": 8,
              "body": {
                "msgId": "{msgId}",
                "cids": "{ids}",
                "requestIp": "search_platform"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "mapping": {
                "_all": {
                  "store": true,
                  "analyzer": "qm_standard",
                  "auto_boost": true
                },
                "dynamic_templates": [
                  {
                    "string_fields": {
                      "mapping": {
                        "index": "not_analyzed",
                        "type": "string",
                        "fields": {
                          "analyzed": {
                            "index": "analyzed",
                            "analyzer": "qm_standard",
                            "type": "string"
                          }
                        }
                      },
                      "match_mapping_type": "string",
                      "match": "*"
                    }
                  },
                  {
                    "long_fields": {
                      "mapping": {
                        "type": "long",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "long",
                      "match": "*"
                    }
                  },
                  {
                    "double_fields": {
                      "mapping": {
                        "type": "double",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "double",
                      "match": "*"
                    }
                  }
                ],
                "properties": {
                  "industryPetInfos": {
                    "type": "nested"
                  },
                  "industryBabyInfos": {
                    "type": "nested"
                  },
                  "industryAMInfos": {
                    "type": "nested"
                  }
                }
              },
              "index": "b2c-connection-grandview",
              "type": "View",
              "id": "{cid}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "b2c-connection-grandview",
              "id": "{cid}"
            }
          ]
        }
      ]
    },
    {
      "desc": "连接大视图的数据删除操作，负责人：沈春南",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.uc.connection.grandview.delete",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "default"
            }
          }
        }
      },
      "branches": [
        {
          "name": "b2c_connection_grandview_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "b2c-connection-grandview",
              "type": "View",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "b2c-connection-grandview",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "d2p营销相关的接口统一由张睿负责",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2p.marketing.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2p_marketing_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.d2p.api.search.SearchActivityQueryProvider",
            "request": {
              "method": "queryMarketingByIds",
              "timeout": 30,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2p-marketing-{hashcode}-{version}",
              "type": "Marketing",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2p-marketing-{hashcode}-{version}",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2p_marketing_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2p-marketing-{hashcode}-{version}",
              "type": "Marketing",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2p-marketing-{hashcode}-{version}",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2p.marketing.itemChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2p_marketing_item_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.d2p.api.search.SearchActivityQueryProvider",
            "request": {
              "method": "queryItemByIds",
              "timeout": 30,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2p-marketing-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2p-marketing-item-{hashcode}-{version}",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2p_marketing_item_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2p-marketing-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2p-marketing-item-{hashcode}-{version}",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2p.marketing.tradeChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2p_marketing_trade_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.d2p.api.search.SearchActivityQueryProvider",
            "request": {
              "method": "queryTradeMarketingRecordByIds",
              "timeout": 30,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2p-marketing-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{tid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2p-marketing-trade-{hashcode}-{version}",
              "id": "{tid}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2p_marketing_trade_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2p-marketing-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2p-marketing-trade-{hashcode}-{version}",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2p.marketing.userCouponChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2p_marketing_usercoupon_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.d2p.api.search.SearchCouponQueryProvider",
            "request": {
              "method": "queryUserCouponByIds",
              "timeout": 30,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2p-marketing-usercoupon-{hashcode}-{version}",
              "type": "Coupon",
              "id": "{couponId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2p-marketing-usercoupon-{hashcode}-{version}",
              "id": "{couponId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2p_marketing_usercoupon_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2p-marketing-usercoupon-{hashcode}-{version}",
              "type": "Coupon",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "d2p-marketing-usercoupon-{hashcode}-{version}",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2p.marketing.integralItem.change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2p_marketing_integralItem_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.d2p.api.search.SearchIntegralItemQueryProvider",
            "request": {
              "method": "queryIntegralItemByIds",
              "timeout": 30,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2p-marketing-integral-items-{hashcode}-{version}",
              "type": "Item",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2p_marketing_integralItem_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "d2p-marketing-integral-items-{hashcode}-{version}",
              "type": "Item",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.searchPlatform.d2p.marketingInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "d2p_marketing_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"marketing\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.d2p.api.search.SearchActivityQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryMarketing",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2p-marketing-{hashcode}-{version}",
              "type": "Marketing",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2p-marketing-{hashcode}-{version}",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2p_marketing_item_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"item\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.d2p.api.search.SearchActivityQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryItem",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2p-marketing-item-{hashcode}-{version}",
              "type": "Item",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2p-marketing-item-{hashcode}-{version}",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2p_marketing_trade_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"trade\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.d2p.api.search.SearchActivityQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryTradeMarketingRecord",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2p-marketing-trade-{hashcode}-{version}",
              "type": "Trade",
              "id": "{tid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2p-marketing-trade-{hashcode}-{version}",
              "id": "{tid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2p_marketing_usercoupon_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"usercoupon\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.d2p.api.search.SearchCouponQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryUserCoupon",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2p-marketing-usercoupon-{hashcode}-{version}",
              "type": "Coupon",
              "id": "{couponId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2p-marketing-usercoupon-{hashcode}-{version}",
              "id": "{couponId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "d2p_marketing_integralItem_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"integralitem\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 1,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.d2p.api.search.SearchIntegralItemQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryIntegralItems",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2p-marketing-integral-items-{hashcode}-{version}",
              "type": "Item",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "收银统一单据凭证初始化，负责人：霍闯",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.acct.uniformOrder.es.bat.syn",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "acctUniformOrder"
            }
          }
        }
      },
      "branches": [
        {
          "name": "acct_uniorders_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "dealTimeStart": "dealTimeStart\":\"(?P<dealTimeStart>[\\d\\D]+?)\"",
                "dealTimeEnd": "dealTimeEnd\":\"(?P<dealTimeEnd>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.acct.query.payment.UniformOrderQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryUniformOrdersForEsSyn",
              "timeout": 10,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "dealTimeStart": "{dealTimeStart}",
                "dealTimeEnd": "{dealTimeEnd}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "acct-uniorders",
              "type": "Order",
              "id": "{uniformOrderId}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "acct-uniorders",
              "id": "{uniformOrderId}"
            }
          ]
        }
      ]
    },
    {
      "desc": "收银统一单据凭证变更，负责人：霍闯",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.acct.uniformOrder.es.syn",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "acctUniformOrder"
            }
          }
        }
      },
      "branches": [
        {
          "name": "acct_uniorders_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"optType\":\"update\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "uniformOrderId": "uniformOrderId\":\"(?P<uniformOrderId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.acct.query.payment.UniformOrderQueryProvider",
            "request": {
              "method": "queryUniformOrderById",
              "timeout": 10,
              "body": {
                "uniformId": "{uniformOrderId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "acct-uniorders",
              "type": "Order",
              "id": "{uniformOrderId}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "acct-uniorders",
              "id": "{uniformOrderId}"
            }
          ]
        },
        {
          "name": "acct_uniorders_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"optType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "uniformOrderIds": "uniformOrderIds\":\"(?P<uniformOrderIds>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "acct-uniorders",
              "type": "Order",
              "id": "{uniformOrderIds}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "acct-uniorders",
              "id": "{uniformOrderIds}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "商品中心rocketmq数据同步消息监听",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_qmpc_ItemChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "pc-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "yun_not_edit_add",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "(\"type\":\"add\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"add\")|(\"type\":\"update\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"update\")"
                },
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"edit\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"addSkuIds\":\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"addSkuIds\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.pc.es.api.EsGoodsQueryProvider",
            "request": {
              "method": "listByIdString",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}",
                  "hashcode": {}
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_vip",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_experience",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "yun_not_edit_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "(\"type\":\"add\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"add\")|(\"type\":\"update\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"update\")"
                },
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"edit\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"updateSkuIds\":\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"updateSkuIds\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.pc.es.api.EsGoodsQueryProvider",
            "request": {
              "method": "listByIdString",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}",
                  "hashcode": {}
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_vip",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_experience",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "yun_edit_add",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "(\"type\":\"add\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"add\")|(\"type\":\"update\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"update\")"
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"edit\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"addSkuIds\":\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"addSkuIds\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.pc.es.api.EsGoodsQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "listByIdString",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_vip",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_experience",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "yun_edit_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "(\"type\":\"add\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"add\")|(\"type\":\"update\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"update\")"
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"edit\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"updateSkuIds\":\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"updateSkuIds\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.pc.es.api.EsGoodsQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "listByIdString",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_vip",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_experience",
                    "operation": "create",
                    "id": "{skuId}",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "yun_edit_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"deleteSkuIds\":\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"sys\":[02]"
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"deleteSkuIds\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_vip",
                    "operation": "delete",
                    "id": "{ids}",
                    "id_process": {
                      "type": "seperate",
                      "separator": ":"
                    },
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "product_experience",
                    "operation": "delete",
                    "id": "{ids}",
                    "id_process": {
                      "type": "seperate",
                      "separator": ":"
                    },
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "spu_yun_not_edit",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "(\"type\":\"add\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"add\")|(\"type\":\"update\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"update\")"
                },
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"edit\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.pc.es.api.EsProductQueryProvider",
            "request": {
              "method": "listByIdString",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_vip",
                    "operation": "create",
                    "id": "{spuId}",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_experience",
                    "operation": "create",
                    "id": "{spuId}",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "spu_yun_edit_add",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "(\"type\":\"add\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"add\")|(\"type\":\"update\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"update\")"
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"edit\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"addSkuIds\":\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"addSkuIds\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.pc.es.api.EsProductQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "listByIdString",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_vip",
                    "operation": "create",
                    "id": "{spuId}",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_experience",
                    "operation": "create",
                    "id": "{spuId}",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "spu_yun_edit_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "(\"type\":\"add\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"add\")|(\"type\":\"update\"[\\d\\D]*\"sys\":[02])|(\"sys\":[02][\\d\\D]*\"type\":\"update\")"
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"edit\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"updateSkuIds\":\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"updateSkuIds\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.pc.es.api.EsProductQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "listByIdString",
              "timeout": 8,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_vip",
                    "operation": "create",
                    "id": "{spuId}",
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_experience",
                    "operation": "create",
                    "id": "{spuId}",
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "spu_yun_edit_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"delete\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"sys\":[02]"
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": {
                  "type": "script",
                  "language": "python",
                  "obj_path": "script_data_parsers.parse_spuids_from_pc_mq_msg",
                  "input_param": {
                    "fields": {
                      "pc_ids": {
                        "type": "regex",
                        "expression": "\"ids\":\"(?P<pc_ids>[\\d\\D]+?)\""
                      },
                      "sep_char": {
                        "type": "fixed",
                        "expression": ","
                      }
                    }
                  }
                },
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 50,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "router": {
                "type": "vip_router",
                "fields": {
                  "adminId": "{adminId}"
                },
                "target": [
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_vip",
                    "operation": "delete",
                    "id": "{ids}",
                    "id_process": {
                      "type": "seperate",
                      "separator": ","
                    },
                    "tag": "vip"
                  },
                  {
                    "destination_type": "elasticsearch",
                    "reference": "spu_experience",
                    "operation": "delete",
                    "id": "{ids}",
                    "id_process": {
                      "type": "seperate",
                      "separator": ","
                    },
                    "tag": "default"
                  }
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "名片小程序群组社区动态信息初始化，负责人：潘儒森（以下notice皆代表动态）",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.qmuc_micro_card.search.notice.page",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc_card_notice"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "uc_card_notice_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "desc": "这里使用adminId是为了添加_adminId私有字段",
                "adminId": "groupId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.uc.card.api.notice.NoticeEsPushProvider",
            "version": "1.0",
            "request": {
              "method": "queryPageByGId",
              "timeout": 10,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "groupId": "{adminId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "uc-card-notice",
              "type": "Notice",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "uc-card-notice",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "名片小程序群组社区动态信息变更，负责人：潘儒森（以下notice皆代表动态）",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.qmuc_micro_card.search.notice.one",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc_card_notice"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "uc_card_notice_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"optType\":\"DELETE\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "groupId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "nid": "nid\":\"(?P<nid>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0",
            "service_interface": "com.qianmi.uc.card.api.notice.NoticeEsPushProvider",
            "request": {
              "method": "queryOneByGIdAndNId",
              "timeout": 10,
              "body": {
                "groupId": "{adminId}",
                "nid": "{nid}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "uc-card-notice",
              "type": "Notice",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "uc-card-notice",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "uc_card_notice_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"optType\":\"DELETE\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "nid": "nid\":\"(?P<nid>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "uc-card-notice",
              "type": "Notice",
              "id": "{nid}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "uc-card-notice",
              "id": "{nid}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "直营门店商品数据的变更，负责人：白晓琳",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.pc.o2o.storeItemChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "msg": {
            "custom_queue_prefix": "pc-"
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "direct_store_update_spu",
          "desc": "直营门店spu更新",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"productType\":\"spu\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"update\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 10,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.pc.es.api.EsProductQueryProvider",
            "request": {
              "method": "listByIdString4Store",
              "timeout": 10,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "direct-store-spu-{hashcode}",
              "type": "Spu",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "direct_store_update_sku",
          "desc": "直营门店sku更新",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"productType\":\"sku\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"update\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 10,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.pc.es.api.EsGoodsQueryProvider",
            "request": {
              "method": "listByIdString4Store",
              "timeout": 10,
              "body": {
                "chainMasterId": "{adminId}",
                "idString": "{ids}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "direct-store-sku-{hashcode}",
              "type": "Sku",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "direct_store_delete_spu",
          "desc": "直营门店删除spu",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"productType\":\"spu\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "comment": "此处的ids和上面更新商品数据ids不一样，这里是联合主键，上面是spuId",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 10,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "direct-store-spu-{hashcode}",
              "type": "Spu",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        },
        {
          "name": "direct_store_delete_sku",
          "desc": "直营门店删除sku",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"productType\":\"sku\""
                },
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "adminId": "chainMasterId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "hashcode": {
                  "type": "hash_modulus",
                  "modulus": 10,
                  "origin_filed": "adminId"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "direct-store-sku-{hashcode}",
              "type": "Sku",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "名片小程序群组相册信息变更，负责人：潘儒森",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_qmuc_micro_card_search_bbs_album_list",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc_card_album"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "uc_card_album_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"optType\":\"DELETE\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "groupId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "nid": "nid\":\"(?P<nid>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0",
            "service_interface": "com.qianmi.uc.card.api.notice.NoticeEsPushProvider",
            "request": {
              "method": "queryAlbumByGIdAndNId",
              "timeout": 10,
              "body": {
                "groupId": "{adminId}",
                "nid": "{nid}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "uc-card-album",
              "type": "Album",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "uc-card-album",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "uc_card_album_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"optType\":\"DELETE\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "nid": "nid\":\"(?P<nid>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "uc-card-album",
              "type": "Album",
              "id": "{nid}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "uc-card-album",
              "id": "{nid}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "名片小程序资料库数据变更，负责人：潘儒森",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.qmuc_micro_card.data.bank.one",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc_card_data_bank"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "uc_card_data_bank_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"optType\":\"DELETE\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "cardId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "archiveId": "archiveId\":\"(?P<archiveId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0",
            "service_interface": "com.qianmi.uc.card.api.databank.pc.ArchiveEsProvider",
            "request": {
              "method": "pullOne",
              "timeout": 10,
              "body": {
                "cardId": "{adminId}",
                "archiveId": "{archiveId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "uc-card-data-bank",
              "type": "DataBank",
              "id": "{archiveId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "uc-card-data-bank",
              "id": "{archiveId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "uc_card_data_bank_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"optType\":\"DELETE\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "archiveId": "archiveId\":\"(?P<archiveId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "uc-card-data-bank",
              "type": "DataBank",
              "id": "{archiveId}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "uc-card-data-bank",
              "id": "{archiveId}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "用户计次卡变更，负责人：张超珉",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.marketing.userCountCardChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "user_count_card_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"update\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.api.search.SearchCountCardQueryProvider",
            "request": {
              "method": "queryUserCountCardByIds",
              "timeout": 30,
              "body": {
                "adminId": "{adminId}",
                "domainType": "{domainType}",
                "ids": "{ids}",
                "msgId": "{msgId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "mapping": {
                "_all": {
                  "store": false
                },
                "dynamic_templates": [
                  {
                    "string_fields": {
                      "mapping": {
                        "index": "not_analyzed",
                        "type": "string",
                        "fields": {
                          "analyzed": {
                            "index": "analyzed",
                            "analyzer": "qm_standard",
                            "type": "string"
                          }
                        }
                      },
                      "match_mapping_type": "string",
                      "match": "*"
                    }
                  },
                  {
                    "long_fields": {
                      "mapping": {
                        "type": "long",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "long",
                      "match": "*"
                    }
                  },
                  {
                    "double_fields": {
                      "mapping": {
                        "type": "double",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "double",
                      "match": "*"
                    }
                  }
                ],
                "properties": {
                  "userCardId": {
                    "type": "string",
                    "index": "not_analyzed",
                    "fields": {
                      "postfix": {
                        "type": "string",
                        "analyzer": "postfix"
                      }
                    }
                  },
                  "cardId": {
                    "type": "string",
                    "index": "not_analyzed",
                    "fields": {
                      "postfix": {
                        "type": "string",
                        "analyzer": "postfix"
                      }
                    }
                  },
                  "tid": {
                    "type": "string",
                    "index": "not_analyzed",
                    "fields": {
                      "postfix": {
                        "type": "string",
                        "analyzer": "postfix"
                      }
                    }
                  }
                }
              },
              "index": "user-count-card",
              "type": "Card",
              "id": "{userCardId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "user-count-card",
              "id": "{userCardId}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "user_count_card_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "user-count-card",
              "type": "Card",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "user-count-card",
              "id": "{ids}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "预约单数据变更，负责人：李健",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.com.qianmi.uc.conn.appointment.AppointmentChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "user_appointment_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "id": "id\":\"(?P<id>[\\d\\D]+?)\"",
                "mqId": "mqId\":\"(?P<mqId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.uc.conn.appointment.api.dubbo.es.AppointmentEsQueryProvider",
            "request": {
              "method": "queryDetailByIdsForEs",
              "timeout": 20,
              "body": {
                "ids": "{id}",
                "mqId": "{mqId}",
                "requestIp": "search_platform"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "mapping": {
                "_all": {
                  "store": false
                },
                "dynamic_templates": [
                  {
                    "string_fields": {
                      "mapping": {
                        "index": "not_analyzed",
                        "type": "string",
                        "fields": {
                          "analyzed": {
                            "index": "analyzed",
                            "analyzer": "qm_standard",
                            "type": "string"
                          }
                        }
                      },
                      "match_mapping_type": "string",
                      "match": "*"
                    }
                  },
                  {
                    "long_fields": {
                      "mapping": {
                        "type": "long",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "long",
                      "match": "*"
                    }
                  },
                  {
                    "double_fields": {
                      "mapping": {
                        "type": "double",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "double",
                      "match": "*"
                    }
                  }
                ],
                "properties": {
                  "phoneNumber": {
                    "type": "string",
                    "index": "not_analyzed",
                    "fields": {
                      "postfix": {
                        "type": "string",
                        "analyzer": "postfix"
                      }
                    }
                  },
                  "appointmentId": {
                    "type": "string",
                    "index": "not_analyzed",
                    "fields": {
                      "postfix": {
                        "type": "string",
                        "analyzer": "postfix"
                      }
                    }
                  }
                }
              },
              "index": "user-conn-appointment",
              "type": "Appointment",
              "id": "{appointmentId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "user-conn-appointment",
              "id": "{appointmentId}",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "市场入驻店铺数据初始化，负责人：白晓琳",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.usercenter.es.b2bStoreInit",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "b2b_market_shop"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "b2b_market_shop_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.uc.query.api.store.search.QueryStore4SearchProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryAllB2BStore",
              "timeout": 10,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "msgId": "{msgId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "operation": "create",
              "index": "b2b-market-shop",
              "type": "Shop",
              "id": "{id}",
              "clear_policy": "every_msg,all"
            }
          ]
        }
      ]
    },
    {
      "desc": "市场入驻店铺数据变更，负责人：白晓琳",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.usercenter.es.b2bStoreChange",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "b2b_market_shop"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "b2b_market_shop_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.uc.query.api.store.search.QueryStore4SearchProvider",
            "request": {
              "method": "listB2BStoreByIds",
              "timeout": 10,
              "body": {
                "ids": "{ids}",
                "msgId": "{msgId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "b2b-market-shop",
              "type": "Shop",
              "id": "{id}"
            }
          ]
        },
        {
          "name": "b2b_market_shop_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "b2b-market-shop",
              "type": "Shop",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ":"
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "市场入驻店铺商品数据初始化，负责人：钱晨",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.qmpc.b2bMarketItemInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "b2b_market_item_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.gcs.purchase.view.api.EsB2BMarketItemViewQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "query",
              "timeout": 10,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "chainMasterId": "{adminId}",
                "msgId": "{msgId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "mapping": {
                "_all": {
                  "store": false
                },
                "dynamic_templates": [
                  {
                    "string_fields": {
                      "mapping": {
                        "index": "not_analyzed",
                        "type": "string",
                        "fields": {
                          "analyzed": {
                            "index": "analyzed",
                            "analyzer": "qm_standard",
                            "type": "string"
                          }
                        }
                      },
                      "match_mapping_type": "string",
                      "match": "*"
                    }
                  },
                  {
                    "long_fields": {
                      "mapping": {
                        "type": "long",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "long",
                      "match": "*"
                    }
                  },
                  {
                    "double_fields": {
                      "mapping": {
                        "type": "double",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "double",
                      "match": "*"
                    }
                  }
                ],
                "properties": {
                  "marketRelated": {
                    "type": "nested"
                  },
                  "skuList": {
                    "type": "nested"
                  },
                  "props": {
                    "type": "nested"
                  },
                  "brand": {
                    "index": "not_analyzed",
                    "type": "string",
                    "fields": {
                      "standard": {
                        "analyzer": "qm_standard",
                        "type": "string"
                      }
                    }
                  },
                  "title": {
                    "index": "not_analyzed",
                    "type": "string",
                    "fields": {
                      "standard": {
                        "analyzer": "qm_standard",
                        "type": "string"
                      }
                    }
                  },
                  "cats": {
                    "type": "nested",
                    "properties": {
                      "childs": {
                        "type": "nested",
                        "properties": {
                          "childs": {
                            "type": "nested",
                            "properties": {
                              "childs": {
                                "type": "nested",
                                "properties": {
                                  "childs": {
                                    "type": "nested",
                                    "properties": {
                                      "childs": {
                                        "type": "nested",
                                        "properties": {
                                          "childs": {
                                            "type": "nested"
                                          },
                                          "id": {
                                            "type": "string",
                                            "index": "not_analyzed"
                                          },
                                          "name": {
                                            "type": "string",
                                            "index": "not_analyzed",
                                            "fields": {
                                              "standard": {
                                                "type": "string",
                                                "analyzer": "qm_standard"
                                              }
                                            }
                                          }
                                        }
                                      },
                                      "id": {
                                        "type": "string",
                                        "index": "not_analyzed"
                                      },
                                      "name": {
                                        "type": "string",
                                        "index": "not_analyzed",
                                        "fields": {
                                          "standard": {
                                            "type": "string",
                                            "analyzer": "qm_standard"
                                          }
                                        }
                                      }
                                    }
                                  },
                                  "id": {
                                    "type": "string",
                                    "index": "not_analyzed"
                                  },
                                  "name": {
                                    "type": "string",
                                    "index": "not_analyzed",
                                    "fields": {
                                      "standard": {
                                        "type": "string",
                                        "analyzer": "qm_standard"
                                      }
                                    }
                                  }
                                }
                              },
                              "id": {
                                "type": "string",
                                "index": "not_analyzed"
                              },
                              "name": {
                                "type": "string",
                                "index": "not_analyzed",
                                "fields": {
                                  "standard": {
                                    "type": "string",
                                    "analyzer": "qm_standard"
                                  }
                                }
                              }
                            }
                          },
                          "id": {
                            "type": "string",
                            "index": "not_analyzed"
                          },
                          "name": {
                            "type": "string",
                            "index": "not_analyzed",
                            "fields": {
                              "standard": {
                                "type": "string",
                                "analyzer": "qm_standard"
                              }
                            }
                          }
                        }
                      },
                      "id": {
                        "type": "string",
                        "index": "not_analyzed"
                      },
                      "name": {
                        "type": "string",
                        "index": "not_analyzed",
                        "fields": {
                          "standard": {
                            "type": "string",
                            "analyzer": "qm_standard"
                          }
                        }
                      }
                    }
                  }
                }
              },
              "operation": "create",
              "index": "b2b-market-item",
              "type": "Item",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "市场入驻店铺商品数据变更，负责人：钱晨",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.qmpc.b2bMarketItemChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "b2b_market_item_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"type\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.gcs.purchase.view.api.EsB2BMarketItemViewQueryProvider",
            "request": {
              "method": "listByIds",
              "timeout": 10,
              "body": {
                "ids": "{ids}",
                "msgId": "{msgId}",
                "chainMasterId": "{adminId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "mapping": {
                "_all": {
                  "store": false
                },
                "dynamic_templates": [
                  {
                    "string_fields": {
                      "mapping": {
                        "index": "not_analyzed",
                        "type": "string",
                        "fields": {
                          "analyzed": {
                            "index": "analyzed",
                            "analyzer": "qm_standard",
                            "type": "string"
                          }
                        }
                      },
                      "match_mapping_type": "string",
                      "match": "*"
                    }
                  },
                  {
                    "long_fields": {
                      "mapping": {
                        "type": "long",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "long",
                      "match": "*"
                    }
                  },
                  {
                    "double_fields": {
                      "mapping": {
                        "type": "double",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "double",
                      "match": "*"
                    }
                  }
                ],
                "properties": {
                  "marketRelated": {
                    "type": "nested"
                  },
                  "skuList": {
                    "type": "nested"
                  },
                  "props": {
                    "type": "nested"
                  },
                  "brand": {
                    "index": "not_analyzed",
                    "type": "string",
                    "fields": {
                      "standard": {
                        "analyzer": "qm_standard",
                        "type": "string"
                      }
                    }
                  },
                  "title": {
                    "index": "not_analyzed",
                    "type": "string",
                    "fields": {
                      "standard": {
                        "analyzer": "qm_standard",
                        "type": "string"
                      }
                    }
                  },
                  "cats": {
                    "type": "nested",
                    "properties": {
                      "childs": {
                        "type": "nested",
                        "properties": {
                          "childs": {
                            "type": "nested",
                            "properties": {
                              "childs": {
                                "type": "nested",
                                "properties": {
                                  "childs": {
                                    "type": "nested",
                                    "properties": {
                                      "childs": {
                                        "type": "nested",
                                        "properties": {
                                          "childs": {
                                            "type": "nested"
                                          },
                                          "id": {
                                            "type": "string",
                                            "index": "not_analyzed"
                                          },
                                          "name": {
                                            "type": "string",
                                            "index": "not_analyzed",
                                            "fields": {
                                              "standard": {
                                                "type": "string",
                                                "analyzer": "qm_standard"
                                              }
                                            }
                                          }
                                        }
                                      },
                                      "id": {
                                        "type": "string",
                                        "index": "not_analyzed"
                                      },
                                      "name": {
                                        "type": "string",
                                        "index": "not_analyzed",
                                        "fields": {
                                          "standard": {
                                            "type": "string",
                                            "analyzer": "qm_standard"
                                          }
                                        }
                                      }
                                    }
                                  },
                                  "id": {
                                    "type": "string",
                                    "index": "not_analyzed"
                                  },
                                  "name": {
                                    "type": "string",
                                    "index": "not_analyzed",
                                    "fields": {
                                      "standard": {
                                        "type": "string",
                                        "analyzer": "qm_standard"
                                      }
                                    }
                                  }
                                }
                              },
                              "id": {
                                "type": "string",
                                "index": "not_analyzed"
                              },
                              "name": {
                                "type": "string",
                                "index": "not_analyzed",
                                "fields": {
                                  "standard": {
                                    "type": "string",
                                    "analyzer": "qm_standard"
                                  }
                                }
                              }
                            }
                          },
                          "id": {
                            "type": "string",
                            "index": "not_analyzed"
                          },
                          "name": {
                            "type": "string",
                            "index": "not_analyzed",
                            "fields": {
                              "standard": {
                                "type": "string",
                                "analyzer": "qm_standard"
                              }
                            }
                          }
                        }
                      },
                      "id": {
                        "type": "string",
                        "index": "not_analyzed"
                      },
                      "name": {
                        "type": "string",
                        "index": "not_analyzed",
                        "fields": {
                          "standard": {
                            "type": "string",
                            "analyzer": "qm_standard"
                          }
                        }
                      }
                    }
                  }
                }
              },
              "index": "b2b-market-item",
              "type": "Item",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "b2b_market_item_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "b2b-market-item",
              "type": "Item",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "市场入驻店铺订单数据初始化，负责人：钱晨",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.d2p.order.b2bMarketTradeInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "b2b_market_trade_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2p.order.api.b2bmkt.query.B2BMktTradeEsQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "findByAdminId",
              "timeout": 10,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "chainMasterId": "{adminId}",
                "msgId": "{msgId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "mapping": {
                "_all": {
                  "store": false
                },
                "dynamic_templates": [
                  {
                    "string_fields": {
                      "mapping": {
                        "index": "not_analyzed",
                        "type": "string",
                        "fields": {
                          "analyzed": {
                            "index": "analyzed",
                            "analyzer": "qm_standard",
                            "type": "string"
                          }
                        }
                      },
                      "match_mapping_type": "string",
                      "match": "*"
                    }
                  },
                  {
                    "long_fields": {
                      "mapping": {
                        "type": "long",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "long",
                      "match": "*"
                    }
                  },
                  {
                    "double_fields": {
                      "mapping": {
                        "type": "double",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "double",
                      "match": "*"
                    }
                  }
                ],
                "properties": {
                  "relatedMarkets": {
                    "type": "nested"
                  },
                  "tradeItems": {
                    "type": "nested"
                  },
                  "ownTradeItems": {
                    "type": "nested"
                  }
                }
              },
              "operation": "create",
              "index": "b2b-market-trade",
              "type": "Trade",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "市场入驻店铺订单数据变更，负责人：钱晨",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2p.order.b2bMarketTradeChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "b2b_market_trade_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"type\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2p.order.api.b2bmkt.query.B2BMktTradeEsQueryProvider",
            "request": {
              "method": "findByIds",
              "timeout": 10,
              "body": {
                "ids": "{ids}",
                "msgId": "{msgId}",
                "chainMasterId": "{adminId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "mapping": {
                "_all": {
                  "store": false
                },
                "dynamic_templates": [
                  {
                    "string_fields": {
                      "mapping": {
                        "index": "not_analyzed",
                        "type": "string",
                        "fields": {
                          "analyzed": {
                            "index": "analyzed",
                            "analyzer": "qm_standard",
                            "type": "string"
                          }
                        }
                      },
                      "match_mapping_type": "string",
                      "match": "*"
                    }
                  },
                  {
                    "long_fields": {
                      "mapping": {
                        "type": "long",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "long",
                      "match": "*"
                    }
                  },
                  {
                    "double_fields": {
                      "mapping": {
                        "type": "double",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "double",
                      "match": "*"
                    }
                  }
                ],
                "properties": {
                  "relatedMarkets": {
                    "type": "nested"
                  },
                  "tradeItems": {
                    "type": "nested"
                  },
                  "ownTradeItems": {
                    "type": "nested"
                  }
                }
              },
              "index": "b2b-market-trade",
              "type": "Trade",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "b2b_market_trade_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "b2b-market-trade",
              "type": "Trade",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "市场入驻店铺退货单数据初始化，负责人：钱晨",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.d2p.order.b2bMarketReturnOrderInit",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "b2b_market_return_order_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2p.returnorder.api.b2bmkt.query.B2BMktReturnOrderEsQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "findByAdminId",
              "timeout": 10,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "chainMasterId": "{adminId}",
                "msgId": "{msgId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "mapping": {
                "_all": {
                  "store": false
                },
                "dynamic_templates": [
                  {
                    "string_fields": {
                      "mapping": {
                        "index": "not_analyzed",
                        "type": "string",
                        "fields": {
                          "analyzed": {
                            "index": "analyzed",
                            "analyzer": "qm_standard",
                            "type": "string"
                          }
                        }
                      },
                      "match_mapping_type": "string",
                      "match": "*"
                    }
                  },
                  {
                    "long_fields": {
                      "mapping": {
                        "type": "long",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "long",
                      "match": "*"
                    }
                  },
                  {
                    "double_fields": {
                      "mapping": {
                        "type": "double",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "double",
                      "match": "*"
                    }
                  }
                ],
                "properties": {
                  "relatedMarkets": {
                    "type": "nested"
                  },
                  "returnItems": {
                    "type": "nested"
                  }
                }
              },
              "operation": "create",
              "index": "b2b-market-return-trade",
              "type": "Trade",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "市场入驻店铺退货单数据变更，负责人：钱晨",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.d2p.order.b2bMarketReturnOrderChange",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "b2b_market_return_order_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"type\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2p.returnorder.api.b2bmkt.query.B2BMktReturnOrderEsQueryProvider",
            "request": {
              "method": "findByIds",
              "timeout": 10,
              "body": {
                "ids": "{ids}",
                "msgId": "{msgId}",
                "chainMasterId": "{adminId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "mapping": {
                "_all": {
                  "store": false
                },
                "dynamic_templates": [
                  {
                    "string_fields": {
                      "mapping": {
                        "index": "not_analyzed",
                        "type": "string",
                        "fields": {
                          "analyzed": {
                            "index": "analyzed",
                            "analyzer": "qm_standard",
                            "type": "string"
                          }
                        }
                      },
                      "match_mapping_type": "string",
                      "match": "*"
                    }
                  },
                  {
                    "long_fields": {
                      "mapping": {
                        "type": "long",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "long",
                      "match": "*"
                    }
                  },
                  {
                    "double_fields": {
                      "mapping": {
                        "type": "double",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "double",
                      "match": "*"
                    }
                  }
                ],
                "properties": {
                  "relatedMarkets": {
                    "type": "nested"
                  },
                  "returnItems": {
                    "type": "nested"
                  }
                }
              },
              "index": "b2b-market-return-trade",
              "type": "Trade",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "b2b_market_return_order_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "b2b-market-return-trade",
              "type": "Trade",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "社区群信息数据初始化，负责人：时政",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.qmuc_micro_card.search.group.page",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "uc_card_group_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.uc.card.api.group.GroupEsPushProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryPage",
              "timeout": 10,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "msgId": "{msgId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "uc-card-group",
              "type": "Group",
              "id": "{groupId}",
              "clear_policy": "every_msg,all"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "uc-card-group",
              "id": "{groupId}",
              "clear_policy": "every_msg,all"
            }
          ]
        }
      ]
    },
    {
      "desc": "社区群信息数据变更，负责人：时政",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.qmuc_micro_card.search.group.one",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "uc_card_group_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"optType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "groupId": "groupId\":\"(?P<groupId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.uc.card.api.group.GroupEsPushProvider",
            "request": {
              "method": "queryOneByGroupId",
              "timeout": 10,
              "body": {
                "groupId": "{groupId}",
                "msgId": "{msgId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "uc-card-group",
              "type": "Group",
              "id": "{groupId}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "uc-card-group",
              "id": "{groupId}"
            }
          ]
        },
        {
          "name": "uc_card_group_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"optType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "uc-card-group",
              "type": "Group",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ":"
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "uc-card-group",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ":"
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "名片小程序动态信息初始化，负责人：时政（以下notice皆代表动态）",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "q_qmuc_micro_card_search_notice_together_page",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc_notice"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "uc_notice_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.uc.card.api.notice.NoticePolymerizeEsPushProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryNoticeByPage",
              "timeout": 10,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "msgId": "{msgId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "uc-notice",
              "type": "Notice",
              "id": "{id}",
              "clear_policy": "every_msg,all"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "uc-notice",
              "id": "{id}",
              "clear_policy": "every_msg,all"
            }
          ]
        }
      ]
    },
    {
      "desc": "名片小程序动态信息变更，负责人：时政（以下notice皆代表动态）",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_qmuc_micro_card_search_notice_together_one",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc_notice"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "uc_notice_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"optType\":\"DELETE\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "groupId": "groupId\":\"(?P<groupId>[\\d\\D]+?)\"",
                "nid": "nid\":\"(?P<nid>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.uc.card.api.notice.NoticePolymerizeEsPushProvider",
            "request": {
              "method": "queryOneByByGIdAndNId",
              "timeout": 10,
              "body": {
                "groupId": "{groupId}",
                "nid": "{nid}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "uc-notice",
              "type": "Notice",
              "id": "{id}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "uc-notice",
              "id": "{id}"
            }
          ]
        },
        {
          "name": "uc_notice_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"optType\":\"DELETE\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "nid": "nid\":\"(?P<nid>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "uc-notice",
              "type": "Notice",
              "id": "{nid}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "uc-notice",
              "id": "{nid}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "名片小程序动态信息局部更新，负责人：时政（以下notice皆代表动态）",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_qmuc_micro_card_search_tab_one",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "uc_notice"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "uc_notice_update_partition",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"optType\":\"UPDATE\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "data": {
                  "type": "dict"
                }
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "ids_same_prop_update",
              "index": "uc-notice",
              "type": "Notice"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "ids_same_prop_update",
              "index": "uc-notice"
            }
          ]
        }
      ]
    },
    {
      "desc": "导购佣金数据初始化，负责人：易雅琴",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_guide_commission_record_init",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "guide_commission_record_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"INIT\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.guide.api.GuideCommissionRecordEsQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryRecordsForEsForStore",
              "timeout": 10,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "msgId": "{msgId}",
                "adminId": "{adminId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "guide-commission-record",
              "type": "Record",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "guide-commission-record",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "导购佣金数据变更，负责人：易雅琴",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_guide_commission_record_sync",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "guide_commission_record_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"DELETE\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.guide.api.GuideCommissionRecordEsQueryProvider",
            "request": {
              "method": "queryRecordsForEsByIds",
              "timeout": 10,
              "body": {
                "msgId": "{msgId}",
                "adminId": "{adminId}",
                "ids": "{ids}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "guide-commission-record",
              "type": "Record",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "guide-commission-record",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "guide_commission_record_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"DELETE\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "guide-commission-record",
              "type": "Record",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "guide-commission-record",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "商圈大视图数据变更，负责人：沈春南",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_uc_circle_grandview_change",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "circle_grandview_change"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "uc_circle_grandview_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.uc.connection.grandview.api.dubbo.EsQueryProvider",
            "request": {
              "method": "findCircleInfoByIds",
              "timeout": 10,
              "body": {
                "msgId": "{msgId}",
                "ids": "{ids}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "mapping": {
                "_all": {
                  "enabled": false
                },
                "dynamic_templates": [
                  {
                    "string_fields": {
                      "mapping": {
                        "index": "not_analyzed",
                        "type": "string",
                        "fields": {
                          "analyzed": {
                            "index": "analyzed",
                            "analyzer": "qm_standard",
                            "type": "string"
                          }
                        }
                      },
                      "match_mapping_type": "string",
                      "match": "*"
                    }
                  },
                  {
                    "long_fields": {
                      "mapping": {
                        "type": "long",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "long",
                      "match": "*"
                    }
                  },
                  {
                    "double_fields": {
                      "mapping": {
                        "type": "double",
                        "fields": {
                          "double": {
                            "type": "double"
                          },
                          "long": {
                            "type": "long"
                          }
                        }
                      },
                      "match_mapping_type": "double",
                      "match": "*"
                    }
                  }
                ],
                "properties": {
                  "geoLocation": {
                    "type": "geo_point"
                  }
                }
              },
              "index": "uc-circle-grandview",
              "type": "View",
              "id": "{id}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "uc-circle-grandview",
              "id": "{id}"
            }
          ]
        },
        {
          "name": "uc_circle_grandview_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "uc-circle-grandview",
              "type": "View",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "uc-circle-grandview",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "账务对账卖出单据凭证信息变更，负责人：张双双",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_acct_finReconciliationSellOut_esSyn",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "acct"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "acct_fin_reconciliation_sell_out_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"optType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "finReconciliationSellOutId": "finReconciliationSellOutId\":\"(?P<finReconciliationSellOutId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.acct.query.payment.FinReconciliationSellOutQueryProvider",
            "request": {
              "method": "queryFinReconciliationSellOutInfoById",
              "timeout": 10,
              "body": {
                "msgId": "{msgId}",
                "finReconciliationSellOutId": "{finReconciliationSellOutId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "acct-sell-out",
              "type": "Reconciliation",
              "id": "{finReconciliationSellOutId}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "acct-sell-out",
              "id": "{finReconciliationSellOutId}"
            }
          ]
        },
        {
          "name": "acct_fin_reconciliation_sell_out_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"optType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "finReconciliationSellOutId\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "acct-sell-out",
              "type": "Reconciliation",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "acct-sell-out",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "账务对账退款单据凭证信息变更，负责人：张双双",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_acct_finReconciliationRefund_esSyn",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "acct"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "acct_fin_reconciliation_refund_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"optType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "finReconciliationMerRefundNo": "finReconciliationMerRefundNo\":\"(?P<finReconciliationMerRefundNo>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.acct.query.payment.FinReconciliationRefundQueryProvider",
            "request": {
              "method": "queryFinReconciliationRefundInfoById",
              "timeout": 10,
              "body": {
                "msgId": "{msgId}",
                "finReconciliationMerRefundNo": "{finReconciliationMerRefundNo}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "acct-refund",
              "type": "Reconciliation",
              "id": "{finReconciliationMerRefundNo}"
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "acct-refund",
              "id": "{finReconciliationMerRefundNo}"
            }
          ]
        },
        {
          "name": "acct_fin_reconciliation_refund_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"optType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "finReconciliationMerRefundNo\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "acct-refund",
              "type": "Reconciliation",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "acct-refund",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ","
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "营销活动屏蔽商品初始化，负责人：易雅琴",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_activity_item_exclude_init",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "activity_item_exclude_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.api.search.SearchActivityQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryExcludeItem",
              "timeout": 10,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "msgId": "{msgId}",
                "adminId": "{adminId}",
                "domainType": "0032"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-activity-item-exclude",
              "type": "Item",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-activity-item-exclude",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "营销活动屏蔽商品变更，负责人：易雅琴",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_activity_item_exclude_change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "activity_item_exclude_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"DELETE\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.api.search.SearchActivityQueryProvider",
            "request": {
              "method": "queryExcludeItemByIds",
              "timeout": 10,
              "body": {
                "msgId": "{msgId}",
                "adminId": "{adminId}",
                "ids": "{ids}",
                "domainType": "0032"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "marketing-activity-item-exclude",
              "type": "Item",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "marketing-activity-item-exclude",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "activity_item_exclude_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"DELETE\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "marketing-activity-item-exclude",
              "type": "Item",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "marketing-activity-item-exclude",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "市场客户数据初始化，负责人：张志川",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "queue": "q.usercenter.es.b2bCustomerInit",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "b2b_market_customer"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "b2b_market_customer_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.uc.query.api.store.search.QueryStore4SearchProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryAllB2BCustomer",
              "timeout": 10,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "msgId": "{msgId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "operation": "create",
              "index": "b2b-market-customer",
              "type": "Customer",
              "id": "{id}",
              "clear_policy": "every_msg,all"
            }
          ]
        }
      ]
    },
    {
      "desc": "市场客户数据变更，负责人：张志川",
      "notification": {
        "type": "MQ",
        "host": "{mq_host}",
        "topic": "t.usercenter.es.b2bCustomerChange",
        "sla": {
          "data_parser": {
            "type": "fixed",
            "fields": {
              "adminId": "b2b_market_customer"
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "b2b_market_customer_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.uc.query.api.store.search.QueryStore4SearchProvider",
            "request": {
              "method": "listB2BCustomerByIds",
              "timeout": 10,
              "body": {
                "ids": "{ids}",
                "msgId": "{msgId}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "b2b-market-customer",
              "type": "Customer",
              "id": "{id}"
            }
          ]
        },
        {
          "name": "b2b_market_customer_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operatorType\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_experience",
              "index": "b2b-market-customer",
              "type": "Customer",
              "id": "{ids}",
              "operation": "delete",
              "id_process": {
                "type": "seperate",
                "separator": ":"
              }
            }
          ]
        }
      ]
    },
    {
      "desc": "营销中心礼品卡相关数据的初始化，负责人：张睿",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_giftcard_es_init",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          }
        }
      },
      "branches": [
        {
          "name": "gift_card_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"giftcard\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.api.search.SearchGiftCardQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryGiftCard",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-gift-card",
              "type": "Card",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-gift-card",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "user_gift_card_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"userGiftCard\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.api.search.SearchGiftCardQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryUserGiftCard",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-user-gift-card",
              "type": "Card",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-user-gift-card",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "gift_card_use_record_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"giftCardUseRecord\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.api.search.SearchGiftCardQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryGiftCardUseRecord",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "mapping": {
                "properties": {
                  "store.geoLocation": {
                    "type": "geo_point"
                  }
                }
              },
              "index": "marketing-gift-card-use-record",
              "type": "Record",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-gift-card-use-record",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "gift_card_give_record_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"giftCardGiveRecord\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.api.search.SearchGiftCardQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryGiftCardGiveRecord",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "mapping": {
                "properties": {
                  "store.geoLocation": {
                    "type": "geo_point"
                  }
                }
              },
              "index": "marketing-gift-card-give-record",
              "type": "Record",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "gift_card_store_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"giftCardStore\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.api.search.SearchGiftCardQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryGiftCardStore",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "mapping": {
                "properties": {
                  "geoLocation": {
                    "type": "geo_point"
                  }
                }
              },
              "index": "marketing-gift-card-store",
              "type": "Store",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-gift-card-store",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "user_gift_card_store_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"type\":\"userGiftCardStore\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.mc.api.search.SearchGiftCardQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryUserGiftCardStore",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "msgId": "{msgId}",
                "domainType": "{domainType}",
                "pageNum": "{page_from}",
                "pageSize": "{page_size}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "mapping": {
                "properties": {
                  "geoLocation": {
                    "type": "geo_point"
                  }
                }
              },
              "index": "marketing-user-gift-card-store",
              "type": "Store",
              "id": "{id}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "营销中心礼品卡数据变更，负责人：张睿",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_giftcard_change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "gift_card_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.api.search.SearchGiftCardQueryProvider",
            "request": {
              "method": "queryGiftCardByIds",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-gift-card",
              "type": "Card",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-gift-card",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "gift_card_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "marketing-gift-card",
              "type": "Card",
              "id": "{id}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "marketing-gift-card",
              "id": "{id}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "营销中心用户礼品卡数据变更，负责人：张睿",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_giftcard_usergiftcard_change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "user_gift_card_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.api.search.SearchGiftCardQueryProvider",
            "request": {
              "method": "queryUserGiftCardByIds",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "marketing-user-gift-card",
              "type": "Card",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-user-gift-card",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "user_gift_card_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "marketing-user-gift-card",
              "type": "Card",
              "id": "{id}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "marketing-user-gift-card",
              "id": "{id}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "营销中心礼品卡使用记录数据变更，负责人：张睿",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_giftcard_userecord_change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "gift_card_use_record_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.api.search.SearchGiftCardQueryProvider",
            "request": {
              "method": "queryGiftCardUseRecordByIds",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "mapping": {
                "properties": {
                  "store.geoLocation": {
                    "type": "geo_point"
                  }
                }
              },
              "index": "marketing-gift-card-use-record",
              "type": "Record",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-gift-card-use-record",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "gift_card_use_record_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "marketing-gift-card-use-record",
              "type": "Record",
              "id": "{id}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "marketing-gift-card-use-record",
              "id": "{id}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "营销中心礼品卡赠送记录数据变更，负责人：张睿",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_giftcard_giverecord_change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "gift_card_give_record_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.api.search.SearchGiftCardQueryProvider",
            "request": {
              "method": "queryGiftCardGiveRecordByIds",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "mapping": {
                "properties": {
                  "store.geoLocation": {
                    "type": "geo_point"
                  }
                }
              },
              "index": "marketing-gift-card-give-record",
              "type": "Record",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "gift_card_give_record_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "marketing-gift-card-give-record",
              "type": "Record",
              "id": "{id}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "营销中心礼品卡店铺数据变更，负责人：张睿",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_giftcard_store_change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "gift_card_store_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.api.search.SearchGiftCardQueryProvider",
            "request": {
              "method": "queryGiftCardStoreByIds",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "mapping": {
                "properties": {
                  "geoLocation": {
                    "type": "geo_point"
                  }
                }
              },
              "index": "marketing-gift-card-store",
              "type": "Store",
              "id": "{id}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "marketing-gift-card-store",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "gift_card_store_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "marketing-gift-card-store",
              "type": "Store",
              "id": "{id}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "delete",
              "index": "marketing-gift-card-store",
              "id": "{id}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "营销中心用户礼品卡店铺数据变更，负责人：张睿",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_giftcard_usergiftcard_store_change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "user_gift_card_store_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "not",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "domainType": "domainType\":\"(?P<domainType>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.mc.api.search.SearchGiftCardQueryProvider",
            "request": {
              "method": "queryUserGiftCardStoreByIds",
              "timeout": 10,
              "body": {
                "adminId": "{adminId}",
                "ids": "{ids}",
                "msgId": "{msgId}",
                "domainType": "{domainType}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "mapping": {
                "properties": {
                  "geoLocation": {
                    "type": "geo_point"
                  }
                }
              },
              "index": "marketing-user-gift-card-store",
              "type": "Store",
              "id": "{id}",
              "add_admin_id_field": true
            }
          ]
        },
        {
          "name": "user_gift_card_store_delete",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "\"operation\":\"delete\""
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "\"ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "passthrough",
            "fields_reference": "fields"
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "delete",
              "index": "marketing-user-gift-card-store",
              "type": "Store",
              "id": "{id}",
              "id_process": {
                "type": "seperate",
                "separator": ";"
              },
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "订单中心流水收款单数据初始化，负责人：郭鹏",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_d2c_cash_receiveReceipt_init",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_cash_receive_receipt_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryReceiveReceiptPage",
              "timeout": 10,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "msgId": "{msgId}",
                "adminId": "{adminId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-cash-receive-receipt",
              "type": "Receipt",
              "id": "{recTid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-cash-receive-receipt",
              "id": "{recTid}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "订单中心流水收款单数据变更，负责人：郭鹏",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_d2c_cash_receiveReceipt_change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_cash_receive_receipt_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "request": {
              "method": "queryReceiveReceiptListByIds",
              "timeout": 10,
              "body": {
                "msgId": "{msgId}",
                "adminId": "{adminId}",
                "ids": "{ids}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-cash-receive-receipt",
              "type": "Receipt",
              "id": "{recTid}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-cash-receive-receipt",
              "id": "{recTid}",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "订单中心流水退款单数据初始化，负责人：戴万标",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_d2c_cash_refundInfo_init",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_cash_refund_info_init",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "iterator_get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "version": "1.0.0",
            "request": {
              "method": "queryRefundedInfoPage",
              "timeout": 10,
              "body": {
                "pageNum": "{page_from}",
                "pageSize": "{page_size}",
                "msgId": "{msgId}",
                "adminId": "{adminId}"
              }
            },
            "response": {
              "fields": {
                "total": "totalCount",
                "data": "dataList"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "operation": "create",
              "index": "d2c-cash-refund-info",
              "type": "Info",
              "id": "{refId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "operation": "create",
              "index": "d2c-cash-refund-info",
              "id": "{refId}",
              "clear_policy": "every_msg,by_adminId",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    },
    {
      "desc": "订单中心流水退款单数据变更，负责人：戴万标",
      "notification": {
        "type": "RocketMQ",
        "host": "{rocket_mq_host}",
        "topic": "t_d2c_cash_refundInfo_change",
        "sla": {
          "data_parser": {
            "type": "regex",
            "fields": {
              "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\""
            }
          },
          "redo": true
        }
      },
      "branches": [
        {
          "name": "d2c_cash_refund_info_update",
          "notification": {
            "filter": {
              "union_operator": "and",
              "msg_type": "TextMessage",
              "conditions": [
                {
                  "operator": "is",
                  "type": "regex",
                  "expression": "."
                }
              ]
            },
            "data_parser": {
              "type": "regex",
              "fields": {
                "msgId": "msgId\":\"(?P<msgId>[\\d\\D]+?)\"",
                "adminId": "adminId\":\"(?P<adminId>[\\d\\D]+?)\"",
                "ids": "ids\":\"(?P<ids>[\\d\\D]+?)\""
              }
            }
          },
          "source": {
            "type": "get",
            "protocol": "dubbo",
            "host": "{zookeeper_host}",
            "version": "1.0.0",
            "service_interface": "com.qianmi.d2c.tc.cash.api.trade.search.CashierTradeSearchQueryProvider",
            "request": {
              "method": "queryRefundedInfoListByIds",
              "timeout": 10,
              "body": {
                "msgId": "{msgId}",
                "adminId": "{adminId}",
                "ids": "{ids}"
              }
            }
          },
          "destination": [
            {
              "destination_type": "elasticsearch",
              "reference": "general_vip",
              "index": "d2c-cash-refund-info",
              "type": "Info",
              "id": "{refId}",
              "add_admin_id_field": true
            },
            {
              "destination_type": "elasticsearch7",
              "reference": "search_platform_default",
              "index": "d2c-cash-refund-info",
              "id": "{refId}",
              "add_admin_id_field": true
            }
          ]
        }
      ]
    }
  ]
}